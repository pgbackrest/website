<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>pgBackRest - Command Reference
</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></meta>
<meta property="og:site_name" content="pgBackRest - Reliable PostgreSQL Backup &amp; Restore"></meta>
<meta property="og:title" content="pgBackRest - Command Reference"></meta>
<meta property="og:type" content="website"></meta>
<link rel="icon" href="favicon.png" type="image/png"></link>
<meta property="og:image:type" content="image/png"></meta>
<meta property="og:image" content="http://www.pgbackrest.org/logo.png"></meta>
<meta name="description" content="The pgBackRest Command Reference details all commands and options."></meta>
<meta property="og:description" content="The pgBackRest Command Reference details all commands and options."></meta>
<link rel="stylesheet" href="default.css" type="text/css"></link>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VKCRNV73H1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-VKCRNV73H1');</script>
</head><body><div class="page-header"><div class="page-header-title">
pgBackRest
</div><div class="page-header-subtitle">
Command Reference
</div></div><div class="page-menu"><div class="menu-body"><div class="menu"><a class="menu-link" href="/">
Home
</a></div><div class="menu"><a class="menu-link" href="user-guide-index.html">
User Guides
</a></div><div class="menu"><a class="menu-link" href="release.html">
Releases
</a></div><div class="menu"><a class="menu-link" href="configuration.html">
Configuration
</a></div><div class="menu"><a class="menu-link" href="faq.html">
FAQ
</a></div><div class="menu"><a class="menu-link" href="metric.html">
Metrics
</a></div></div></div><div class="page-toc"><div class="page-toc-header"><div class="page-toc-title">
Table of Contents
</div></div><div class="page-toc-body"><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#introduction">
Introduction
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-annotate">
Annotate Command (<span class="id">annotate</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-archive-get">
Archive Get Command (<span class="id">archive-get</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-archive-push">
Archive Push Command (<span class="id">archive-push</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-backup">
Backup Command (<span class="id">backup</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-check">
Check Command (<span class="id">check</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-expire">
Expire Command (<span class="id">expire</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-help">
Help Command (<span class="id">help</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-info">
Info Command (<span class="id">info</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-repo-get">
Repository Get Command (<span class="id">repo-get</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-repo-ls">
Repository List Command (<span class="id">repo-ls</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-restore">
Restore Command (<span class="id">restore</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-server">
Server Command (<span class="id">server</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-server-ping">
Server Ping Command (<span class="id">server-ping</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-stanza-create">
Stanza Create Command (<span class="id">stanza-create</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-stanza-delete">
Stanza Delete Command (<span class="id">stanza-delete</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-stanza-upgrade">
Stanza Upgrade Command (<span class="id">stanza-upgrade</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-start">
Start Command (<span class="id">start</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-stop">
Stop Command (<span class="id">stop</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-verify">
Verify Command (<span class="id">verify</span>)
</a></div></div><div class="section1-toc"><div class="section1-toc-number"></div><div class="section1-toc-title"><a href="#command-version">
Version Command (<span class="id">version</span>)
</a></div></div></div></div><div class="page-body"><div class="section1"><a id="introduction"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Introduction
</div></div><div class="section-body"><div class="section-body-text">
Commands are used to execute the various <span class="backrest">pgBackRest</span> functions. Here the command options are listed exhaustively, that is, each option applicable to a command is listed with that command even if it applies to one or more other commands. This includes all the options that may also be configured in <span class="file">pgbackrest.conf</span>.
</div><div class="section-body-text">
Non-boolean options configured in <span class="file">pgbackrest.conf</span> can be reset to default on the command-line by using the <span class="id">reset-</span> prefix. This feature may be used to restore a backup directly on a repository host. Normally, <span class="backrest">pgBackRest</span> will error because it can see that the database host is remote and restores cannot be done remotely. By adding <span class="br-option">--reset-pg1-host</span> on the command-line, <span class="backrest">pgBackRest</span> will ignore the remote database host and restore locally. It may be necessary to pass a new <span class="br-option">--pg1-path</span> to force the restore to happen in a specific path, i.e. not the path used on the database host.
</div><div class="section-body-text">
The <span class="id">no-</span> prefix may be used to set a boolean option to false on the command-line.
</div><div class="section-body-text">
Any option may be set in an environment variable using the <span class="id">PGBACKREST_</span> prefix and the option name in all caps replacing <span class="id">-</span> with <span class="id">_</span>, e.g. <span class="br-option">pg1-path</span> becomes <span class="id">PGBACKREST_PG1_PATH</span> and <span class="br-option">stanza</span> becomes <span class="id">PGBACKREST_STANZA</span>. Boolean options are represented as they would be in a configuration file, e.g. <span class="id">PGBACKREST_COMPRESS="n"</span>, and <span class="id">reset-*</span> variants are not allowed. Options that can be specified multiple times on the command-line or in a config file can be represented by separating the values with colons, e.g. <span class="id">PGBACKREST_DB_INCLUDE="db1:db2"</span>.
</div><div class="section-body-text">
Command-line options override environment options which override config file options.
</div><div class="section-body-text">
See <a href="configuration.html#introduction">Configuration Introduction</a> for information on option types
</div></div></div><div class="section1"><a id="command-annotate"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Annotate Command (<span class="id">annotate</span>)
</div></div><div class="section-body"><div class="section-body-text">
Annotations included with the <span class="cmd">backup</span> command can be added, modified, or removed afterwards using the <span class="cmd">annotate</span> command.
</div><div class="section2"><a id="command-annotate/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-annotate/category-command/option-annotation"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Backup Annotation Option (<span class="id">--annotation</span>)
</div></div><div class="section-body"><div class="section-body-text">
Annotate backup with user-defined key/value pairs.
</div><div class="section-body-text">
Users can attach informative key/value pairs to the backup. This option may be used multiple times to attach multiple annotations.
</div><div class="section-body-text">
Annotations are output by the <span class="cmd">info</span> command text output when a backup is specified with <span class="br-option">--set</span> and always appear in the JSON output.
</div>
<pre class="code-block">example: --annotation=source="Sunday backup for website database"</pre>
</div></div><div class="section3"><a id="command-annotate/category-command/option-set"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Option (<span class="id">--set</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup set to annotate.
</div><div class="section-body-text">
The backup set to annotate.
</div>
<pre class="code-block">example: --set=20150131-153358F_20150131-153401I</pre>
</div></div></div></div><div class="section2"><a id="command-annotate/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-annotate/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-annotate/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-annotate/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-annotate/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-annotate/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-annotate/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-annotate/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-annotate/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-annotate/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-annotate/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-annotate/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-annotate/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-archive-get"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Archive Get Command (<span class="id">archive-get</span>)
</div></div><div class="section-body"><div class="section-body-text">
This command is used by <span class="postgres">PostgreSQL</span> to restore a backup, perform PITR, or as an alternative to streaming for keeping a replica up to date. WAL segments are required for <span class="postgres">PostgreSQL</span> recovery or to maintain a replica.
</div><div class="section-body-text">
When multiple repositories are configured, WAL will be fetched from the repositories in priority order (e.g. <span class="id">repo1</span>, <span class="id">repo2</span>, etc.). In general it is better if faster/cheaper storage has higher priority. If a repository is specified with the <span class="br-option">--repo</span> option then only that repository will be searched.
</div><div class="section-body-text">
The <span class="cmd">archive-get</span> command is configured and generated by <span class="backrest">pgBackRest</span> during a restore for use by <span class="postgres">PostgreSQL</span>. See <a href="user-guide.html#pitr">Point-in-Time Recovery</a> for an example.
</div><div class="section2"><a id="command-archive-get/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-command/option-archive-async"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Asynchronous Archiving Option (<span class="id">--archive-async</span>)
</div></div><div class="section-body"><div class="section-body-text">
Push/get WAL segments asynchronously.
</div><div class="section-body-text">
Enables asynchronous operation for the <span class="cmd">archive-push</span> and <span class="cmd">archive-get</span> commands.
</div><div class="section-body-text">
Asynchronous operation is more efficient because it can reuse connections and take advantage of parallelism. See the <span class="br-option">spool-path</span>, <span class="br-option">archive-get-queue-max</span>, and <span class="br-option">archive-push-queue-max</span> options for more information.
</div>
<pre class="code-block">default: n
example: --archive-async</pre>
</div></div><div class="section3"><a id="command-archive-get/category-command/option-archive-get-queue-max"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Maximum Archive Get Queue Size Option (<span class="id">--archive-get-queue-max</span>)
</div></div><div class="section-body"><div class="section-body-text">
Maximum size of the <span class="backrest">pgBackRest</span> archive-get queue.
</div><div class="section-body-text">
Specifies the maximum size of the <span class="cmd">archive-get</span> queue when <span class="br-option">archive-async</span> is enabled. The queue is stored in the <span class="br-option">spool-path</span> and is used to speed providing WAL to <span class="postgres">PostgreSQL</span>.
</div>
<pre class="code-block">default: 128MiB
allowed: 0B-4PiB
example: --archive-get-queue-max=1GiB</pre>
</div></div><div class="section3"><a id="command-archive-get/category-command/option-archive-missing-retry"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Retry Missing WAL Segment Option (<span class="id">--archive-missing-retry</span>)
</div></div><div class="section-body"><div class="section-body-text">
Retry missing WAL segment
</div><div class="section-body-text">
Retry a WAL segment that was previously reported as missing by the <span class="cmd">archive-get</span> command when in asynchronous mode. This prevents notifications in the spool path from a prior restore from being used and possibly causing a recovery failure if consistency has not been reached.
</div><div class="section-body-text">
Disabling this option allows <span class="postgres">PostgreSQL</span> to more reliably recognize when the end of the WAL in the archive has been reached, which permits it to switch over to streaming from the primary. With retries enabled, a steady stream of WAL being archived will cause <span class="postgres">PostgreSQL</span> to continue getting WAL from the archive rather than switch to streaming.
</div><div class="section-body-text">
When disabling this option it is important to ensure that the spool path for the stanza is empty. The <span class="cmd">restore</span> command does this automatically if the spool path is configured at restore time. Otherwise, it is up to the user to ensure the spool path is empty.
</div>
<pre class="code-block">default: y
example: --no-archive-missing-retry</pre>
</div></div><div class="section3"><a id="command-archive-get/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Timeout Option (<span class="id">--archive-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Archive timeout.
</div><div class="section-body-text">
Set maximum time, in seconds, to wait for each WAL segment to reach the <span class="backrest">pgBackRest</span> archive repository. The timeout applies to the <span class="cmd">check</span> and <span class="cmd">backup</span> commands when waiting for WAL segments required for backup consistency to be archived.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1d
example: --archive-timeout=30</pre>
</div></div></div></div><div class="section2"><a id="command-archive-get/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Process Maximum Option (<span class="id">--process-max</span>)
</div></div><div class="section-body"><div class="section-body-text">
Max processes to use for compress/transfer.
</div><div class="section-body-text">
Each process will perform compression and transfer to make the command run faster, but don't set <span class="br-setting">process-max</span> so high that it impacts database performance.
</div>
<pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-spool-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Spool Path Option (<span class="id">--spool-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where transient data is stored.
</div><div class="section-body-text">
This path is used to store data for the asynchronous <span class="cmd">archive-push</span> and <span class="cmd">archive-get</span> command.
</div><div class="section-body-text">
The asynchronous <span class="cmd">archive-push</span> command writes acknowledgements into the spool path when it has successfully stored WAL in the archive (and errors on failure) so the foreground process can quickly notify <span class="postgres">PostgreSQL</span>. Acknowledgement files are very small (zero on success and a few hundred bytes on error).
</div><div class="section-body-text">
The asynchronous <span class="cmd">archive-get</span> command queues WAL in the spool path so it can be provided very quickly when <span class="postgres">PostgreSQL</span> requests it. Moving files to <span class="postgres">PostgreSQL</span> is most efficient when the spool path is on the same filesystem as <span class="path">pg_xlog</span>/<span class="path">pg_wal</span>.
</div><div class="section-body-text">
The data stored in the spool path is not strictly temporary since it can and should survive a reboot. However, loss of the data in the spool path is not a problem. <span class="backrest">pgBackRest</span> will simply recheck each WAL segment to ensure it is safely archived for <span class="cmd">archive-push</span> and rebuild the queue for <span class="cmd">archive-get</span>.
</div><div class="section-body-text">
The spool path is intended to be located on a local Posix-compatible filesystem, not a remote filesystem such as <span class="host">NFS</span> or <span class="host">CIFS</span>.
</div>
<pre class="code-block">default: /var/spool/pgbackrest
example: --spool-path=/backup/db/spool</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-archive-get/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-archive-get/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-archive-get/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-archive-get/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-archive-get/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-archive-get/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-archive-get/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-archive-get/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-archive-get/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-target-time"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Time for Repository Option (<span class="id">--repo-target-time</span>)
</div></div><div class="section-body"><div class="section-body-text">
Target time for repository.
</div><div class="section-body-text">
The target time defines the time that commands use to read a repository on versioned storage. This allows the command to read the repository as it was at a point-in-time in order to recover data that has been deleted or corrupted by user accident or malware.
</div><div class="section-body-text">
Versioned storage is supported by <span class="host">S3</span>, <span class="host">GCS</span>, and <span class="host">Azure</span> but is generally not enabled by default. In addition to enabling versioning, it may be useful to enable object locking for <span class="host">S3</span> and soft delete for <span class="host">GCS</span> or <span class="host">Azure</span>.
</div><div class="section-body-text">
When the <span class="br-option">repo-target-time</span> option is specified then the <span class="br-option">repo</span> option must also be provided. It is likely that not all repository types will support versioning and in general it makes sense to target a single repository for recovery.
</div><div class="section-body-text">
Note that comparisons to the storage timestamp are <= the timestamp provided and milliseconds are truncated from the timestamp when provided.
</div>
<pre class="code-block">example: --repo-target-time=2024-08-08 12:12:12+00</pre>
</div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-archive-get/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div></div></div></div></div><div class="section1"><a id="command-archive-push"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Archive Push Command (<span class="id">archive-push</span>)
</div></div><div class="section-body"><div class="section-body-text">
Accepts a WAL segment from <span class="postgres">PostgreSQL</span> and archives it in each repository defined by the indexed <span class="br-setting">repo-path</span> option (see the <a href="configuration.html#section-repository">Repository</a> section for information on configuring repositories). The WAL segment may be pushed immediately to the archive or stored locally depending on the value of <span class="br-setting">archive-async</span>. With multiple repositories configured, <span class="cmd">archive-push</span> will attempt to push to as many repositories as possible.
</div><div class="section-body-text">
The <span class="cmd">archive-push</span> is intended to be configured and called by <span class="postgres">PostgreSQL</span>. See <a href="user-guide.html#quickstart/configure-archiving">Configure Archiving</a> for an example.
</div><div class="section2"><a id="command-archive-push/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-command/option-archive-async"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Asynchronous Archiving Option (<span class="id">--archive-async</span>)
</div></div><div class="section-body"><div class="section-body-text">
Push/get WAL segments asynchronously.
</div><div class="section-body-text">
Enables asynchronous operation for the <span class="cmd">archive-push</span> and <span class="cmd">archive-get</span> commands.
</div><div class="section-body-text">
Asynchronous operation is more efficient because it can reuse connections and take advantage of parallelism. See the <span class="br-option">spool-path</span>, <span class="br-option">archive-get-queue-max</span>, and <span class="br-option">archive-push-queue-max</span> options for more information.
</div>
<pre class="code-block">default: n
example: --archive-async</pre>
</div></div><div class="section3"><a id="command-archive-push/category-command/option-archive-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Check Archive Option (<span class="id">--archive-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check that WAL segments are in the archive before backup completes.
</div><div class="section-body-text">
Checks that all WAL segments required to make the backup consistent are present in the WAL archive. It's a good idea to leave this as the default unless you are using another method for archiving.
</div><div class="section-body-text">
This option must be enabled if <span class="br-option">archive-copy</span> is enabled.
</div>
<pre class="code-block">default: y
example: --no-archive-check</pre>
</div></div><div class="section3"><a id="command-archive-push/category-command/option-archive-mode-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Check Archive Mode Option (<span class="id">--archive-mode-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check the <span class="postgres">PostgreSQL</span> <span class="br-setting">archive_mode</span> setting.
</div><div class="section-body-text">
Enabled by default, this option disallows <span class="postgres">PostgreSQL</span> <span class="br-setting">archive_mode=always</span>.
</div><div class="section-body-text">
WAL segments pushed from a standby server might be logically the same as WAL segments pushed from the primary but have different checksums. Disabling archiving from multiple sources is recommended to avoid conflicts.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
If this option is disabled then it is critical to ensure that only one archiver is writing to the repository via the <span class="cmd">archive-push</span> command.
</div></div>
<pre class="code-block">default: y
example: --no-archive-mode-check</pre>
</div></div><div class="section3"><a id="command-archive-push/category-command/option-archive-push-queue-max"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Maximum Archive Push Queue Size Option (<span class="id">--archive-push-queue-max</span>)
</div></div><div class="section-body"><div class="section-body-text">
Maximum size of the <span class="postgres">PostgreSQL</span> archive queue.
</div><div class="section-body-text">
After the limit is reached, the following will happen:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="backrest">pgBackRest</span> will notify <span class="postgres">PostgreSQL</span> that the WAL was successfully archived, then <b>DROP IT</b>.
</li><li class="list-unordered">
A warning will be output to the <span class="postgres">PostgreSQL</span> log.
</li></ul><div class="section-body-text">
If this occurs then the archive log stream will be interrupted and PITR will not be possible past that point. A new backup will be required to regain full restore capability.
</div><div class="section-body-text">
In asynchronous mode the entire queue will be dropped to prevent spurts of WAL getting through before the queue limit is exceeded again.
</div><div class="section-body-text">
The purpose of this feature is to prevent the log volume from filling up at which point <span class="postgres">PostgreSQL</span> will stop completely. Better to lose the backup than have <span class="postgres">PostgreSQL</span> go down.
</div>
<pre class="code-block">allowed: 0B-4PiB
example: --archive-push-queue-max=1TiB</pre>
<div class="section-body-text">
Deprecated Name: archive-queue-max
</div></div></div><div class="section3"><a id="command-archive-push/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Timeout Option (<span class="id">--archive-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Archive timeout.
</div><div class="section-body-text">
Set maximum time, in seconds, to wait for each WAL segment to reach the <span class="backrest">pgBackRest</span> archive repository. The timeout applies to the <span class="cmd">check</span> and <span class="cmd">backup</span> commands when waiting for WAL segments required for backup consistency to be archived.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1d
example: --archive-timeout=30</pre>
</div></div></div></div><div class="section2"><a id="command-archive-push/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-compress"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Compress Option (<span class="id">--compress</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use file compression.
</div><div class="section-body-text">
Backup files are compatible with command-line compression tools.
</div><div class="section-body-text">
This option is now deprecated. The <span class="br-setting">compress-type</span> option should be used instead.
</div>
<pre class="code-block">default: y
example: --no-compress</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-compress-level"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Compress Level Option (<span class="id">--compress-level</span>)
</div></div><div class="section-body"><div class="section-body-text">
File compression level.
</div><div class="section-body-text">
Sets the level to be used for file compression when <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> or <span class="br-setting">compress=y</span> (deprecated).
</div><div class="section-body-text">
The following are the defaults levels based on <span class="br-setting">compress-type</span> when <span class="br-setting">compress-level</span> is not specified:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">bz2</span> - 9
</li><li class="list-unordered">
<span class="id">gz</span> - 6
</li><li class="list-unordered">
<span class="id">lz4</span> - 1
</li><li class="list-unordered">
<span class="id">zst</span> - 3
</li></ul>
<pre class="code-block">example: --compress-level=9</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-compress-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Compress Type Option (<span class="id">--compress-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
File compression type.
</div><div class="section-body-text">
The following compression types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - no compression
</li><li class="list-unordered">
<span class="id">bz2</span> - bzip2 compression format
</li><li class="list-unordered">
<span class="id">gz</span> - gzip compression format
</li><li class="list-unordered">
<span class="id">lz4</span> - lz4 compression format (not available on all platforms)
</li><li class="list-unordered">
<span class="id">zst</span> - Zstandard compression format (not available on all platforms)
</li></ul>
<pre class="code-block">default: gz
example: --compress-type=none</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Process Maximum Option (<span class="id">--process-max</span>)
</div></div><div class="section-body"><div class="section-body-text">
Max processes to use for compress/transfer.
</div><div class="section-body-text">
Each process will perform compression and transfer to make the command run faster, but don't set <span class="br-setting">process-max</span> so high that it impacts database performance.
</div>
<pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-spool-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Spool Path Option (<span class="id">--spool-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where transient data is stored.
</div><div class="section-body-text">
This path is used to store data for the asynchronous <span class="cmd">archive-push</span> and <span class="cmd">archive-get</span> command.
</div><div class="section-body-text">
The asynchronous <span class="cmd">archive-push</span> command writes acknowledgements into the spool path when it has successfully stored WAL in the archive (and errors on failure) so the foreground process can quickly notify <span class="postgres">PostgreSQL</span>. Acknowledgement files are very small (zero on success and a few hundred bytes on error).
</div><div class="section-body-text">
The asynchronous <span class="cmd">archive-get</span> command queues WAL in the spool path so it can be provided very quickly when <span class="postgres">PostgreSQL</span> requests it. Moving files to <span class="postgres">PostgreSQL</span> is most efficient when the spool path is on the same filesystem as <span class="path">pg_xlog</span>/<span class="path">pg_wal</span>.
</div><div class="section-body-text">
The data stored in the spool path is not strictly temporary since it can and should survive a reboot. However, loss of the data in the spool path is not a problem. <span class="backrest">pgBackRest</span> will simply recheck each WAL segment to ensure it is safely archived for <span class="cmd">archive-push</span> and rebuild the queue for <span class="cmd">archive-get</span>.
</div><div class="section-body-text">
The spool path is intended to be located on a local Posix-compatible filesystem, not a remote filesystem such as <span class="host">NFS</span> or <span class="host">CIFS</span>.
</div>
<pre class="code-block">default: /var/spool/pgbackrest
example: --spool-path=/backup/db/spool</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-archive-push/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-archive-push/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-archive-push/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-archive-push/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-archive-push/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-archive-push/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-archive-push/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-archive-push/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-maintainer/option-archive-header-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Check WAL Headers Option (<span class="id">--archive-header-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check PostgreSQL version/id in WAL headers.
</div><div class="section-body-text">
Enabled by default, this option checks the WAL header against the <span class="postgres">PostgreSQL</span> version and system identifier to ensure that the WAL is being copied to the correct stanza. This is in addition to checking <span class="file">pg_control</span> against the stanza and verifying that WAL is being copied from the same <span class="postgres">PostgreSQL</span> data directory where <span class="file">pg_control</span> is located.
</div><div class="section-body-text">
Therefore, disabling this check is fairly safe but should only be done when needed, e.g. if the WAL is encrypted.
</div>
<pre class="code-block">default: y
example: --no-archive-header-check</pre>
</div></div><div class="section3"><a id="command-archive-push/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-archive-push/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-archive-push/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div></div></div></div></div><div class="section1"><a id="command-backup"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Backup Command (<span class="id">backup</span>)
</div></div><div class="section-body"><div class="section-body-text">
When multiple repositories are configured, <span class="backrest">pgBackRest</span> will backup to the highest priority repository (e.g. <span class="id">repo1</span>) unless the <span class="br-option">--repo</span> option is specified.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> does not have a built-in scheduler so it's best to run it from cron or some other scheduling mechanism.
</div><div class="section-body-text">
See <a href="user-guide.html#quickstart/perform-backup">Perform a Backup</a> for more details and examples.
</div><div class="section2"><a id="command-backup/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-command/option-annotation"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Backup Annotation Option (<span class="id">--annotation</span>)
</div></div><div class="section-body"><div class="section-body-text">
Annotate backup with user-defined key/value pairs.
</div><div class="section-body-text">
Users can attach informative key/value pairs to the backup. This option may be used multiple times to attach multiple annotations.
</div><div class="section-body-text">
Annotations are output by the <span class="cmd">info</span> command text output when a backup is specified with <span class="br-option">--set</span> and always appear in the JSON output.
</div>
<pre class="code-block">example: --annotation=source="Sunday backup for website database"</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-archive-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Check Archive Option (<span class="id">--archive-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check that WAL segments are in the archive before backup completes.
</div><div class="section-body-text">
Checks that all WAL segments required to make the backup consistent are present in the WAL archive. It's a good idea to leave this as the default unless you are using another method for archiving.
</div><div class="section-body-text">
This option must be enabled if <span class="br-option">archive-copy</span> is enabled.
</div>
<pre class="code-block">default: y
example: --no-archive-check</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-archive-copy"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Copy Archive Option (<span class="id">--archive-copy</span>)
</div></div><div class="section-body"><div class="section-body-text">
Copy WAL segments needed for consistency to the backup.
</div><div class="section-body-text">
This slightly paranoid option protects against corruption in the WAL segment archive by storing the WAL segments required for consistency directly in the backup. WAL segments are still stored in the archive so this option will use additional space.
</div><div class="section-body-text">
It is best if the <span class="cmd">archive-push</span> and <span class="cmd">backup</span> commands have the same <span class="br-setting">compress-type</span> (e.g. <span class="id">lz4</span>) when using this option. Otherwise, the WAL segments will need to be recompressed with the <span class="br-setting">compress-type</span> used by the backup, which can be fairly expensive depending on how much WAL was generated during the backup.
</div><div class="section-body-text">
On restore, the WAL segments will be present in <span class="path">pg_xlog/pg_wal</span> and <span class="postgres">PostgreSQL</span> will use them in preference to calling the <span class="id">restore_command</span>.
</div><div class="section-body-text">
The <span class="br-option">archive-check</span> option must be enabled if <span class="br-option">archive-copy</span> is enabled.
</div>
<pre class="code-block">default: n
example: --archive-copy</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-archive-mode-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Check Archive Mode Option (<span class="id">--archive-mode-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check the <span class="postgres">PostgreSQL</span> <span class="br-setting">archive_mode</span> setting.
</div><div class="section-body-text">
Enabled by default, this option disallows <span class="postgres">PostgreSQL</span> <span class="br-setting">archive_mode=always</span>.
</div><div class="section-body-text">
WAL segments pushed from a standby server might be logically the same as WAL segments pushed from the primary but have different checksums. Disabling archiving from multiple sources is recommended to avoid conflicts.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
If this option is disabled then it is critical to ensure that only one archiver is writing to the repository via the <span class="cmd">archive-push</span> command.
</div></div>
<pre class="code-block">default: y
example: --no-archive-mode-check</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Timeout Option (<span class="id">--archive-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Archive timeout.
</div><div class="section-body-text">
Set maximum time, in seconds, to wait for each WAL segment to reach the <span class="backrest">pgBackRest</span> archive repository. The timeout applies to the <span class="cmd">check</span> and <span class="cmd">backup</span> commands when waiting for WAL segments required for backup consistency to be archived.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1d
example: --archive-timeout=30</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-backup-standby"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Backup from Standby Option (<span class="id">--backup-standby</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup from the standby cluster.
</div><div class="section-body-text">
Enable backup from standby to reduce load on the primary cluster. This option requires that both the <span class="host">primary</span> and <span class="host">standby</span> hosts be configured.
</div><div class="section-body-text">
The following modes are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">y</span> - Standby is required for backup.
</li><li class="list-unordered">
<span class="id">prefer</span> - Backup from standby if available otherwise backup from primary.
</li><li class="list-unordered">
<span class="id">n</span> - Backup from primary only.
</li></ul>
<pre class="code-block">default: n
example: --backup-standby=y</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-checksum-page"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Page Checksums Option (<span class="id">--checksum-page</span>)
</div></div><div class="section-body"><div class="section-body-text">
Validate data page checksums.
</div><div class="section-body-text">
Directs <span class="backrest">pgBackRest</span> to validate all data page checksums while backing up a cluster. This option is automatically enabled when data page checksums are enabled on the cluster.
</div><div class="section-body-text">
Failures in checksum validation will not abort a backup. Rather, warnings will be emitted in the log (and to the console with default settings) and the list of invalid pages will be stored in the backup manifest.
</div>
<pre class="code-block">example: --no-checksum-page</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-exclude"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Path/File Exclusions Option (<span class="id">--exclude</span>)
</div></div><div class="section-body"><div class="section-body-text">
Exclude paths/files from the backup.
</div><div class="section-body-text">
All exclusions are relative to <span class="path">$PGDATA</span>. If the exclusion ends with / then only files in the specified directory will be excluded, e.g. <span class="br-option">--exclude=junk/</span> will exclude all files in the <span class="path">$PGDATA/junk</span> directory but include the directory itself. If the exclusion does not end with / then the file may match the exclusion exactly or match with / appended to the exclusion, e.g. <span class="br-option">--exclude=junk</span> will exclude the <span class="path">$PGDATA/junk</span> directory and all the files it contains.
</div><div class="section-body-text">
<b>Be careful using this feature -- it is very easy to exclude something critical that will make the backup inconsistent. Be sure to test your restores!</b>
</div><div class="section-body-text">
All excluded files will be logged at <span class="id">info</span> level along with the exclusion rule. Be sure to audit the list of excluded files to ensure nothing unexpected is being excluded.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
Exclusions are not honored on delta restores. Any files/directories that were excluded by the backup will be <i>removed</i> on delta restore.
</div></div><div class="section-body-text">
This option should not be used to exclude <span class="postgres">PostgreSQL</span> logs from a backup. Logs can be moved out of the <span class="id">PGDATA</span> directory using the <span class="postgres">PostgreSQL</span> <span class="br-setting">log_directory</span> setting, which has the benefit of allowing logs to be preserved after a restore.
</div><div class="section-body-text">
Multiple exclusions may be specified on the command-line or in a configuration file.
</div>
<pre class="code-block">example: --exclude=junk/</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-expire-auto"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Expire Auto Option (<span class="id">--expire-auto</span>)
</div></div><div class="section-body"><div class="section-body-text">
Automatically run the <span class="cmd">expire</span> command after a successful backup.
</div><div class="section-body-text">
The setting is enabled by default. Use caution when disabling this option as doing so will result in retaining all backups and archives indefinitely, which could cause your repository to run out of space. The <span class="cmd">expire</span> command will need to be run regularly to prevent this from happening.
</div>
<pre class="code-block">default: y
example: --expire-auto</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force Option (<span class="id">--force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force an offline backup.
</div><div class="section-body-text">
When used with <span class="br-option">--no-start-stop</span> a backup will be run even if <span class="backrest">pgBackRest</span> thinks that <span class="postgres">PostgreSQL</span> is running. <b>This option should be used with extreme care as it will likely result in a bad backup.</b>
</div><div class="section-body-text">
There are some scenarios where a backup might still be desirable under these conditions. For example, if a server crashes and the database cluster volume can only be mounted read-only, it would be a good idea to take a backup even if <span class="file">postma&#115;ter.pid</span> is present. In this case it would be better to revert to the prior backup and replay WAL, but possibly there is a very important transaction in a WAL segment that did not get archived.
</div>
<pre class="code-block">default: n
example: --force</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-manifest-save-threshold"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Manifest Save Threshold Option (<span class="id">--manifest-save-threshold</span>)
</div></div><div class="section-body"><div class="section-body-text">
Manifest save threshold during backup.
</div><div class="section-body-text">
Defines how often the manifest will be saved during a backup. Saving the manifest is important because it stores the checksums and allows the resume function to work efficiently. The actual threshold used is 1% of the backup size or <span class="br-setting">manifest-save-threshold</span>, whichever is greater.
</div>
<pre class="code-block">default: 1GiB
allowed: 1B-1TiB
example: --manifest-save-threshold=8GiB</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-online"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Online Option (<span class="id">--online</span>)
</div></div><div class="section-body"><div class="section-body-text">
Perform an online backup.
</div><div class="section-body-text">
Specifying --no-online prevents <span class="backrest">pgBackRest</span> from running the backup start/stop functions on the database cluster. In order for this to work <span class="postgres">PostgreSQL</span> should be shut down and <span class="backrest">pgBackRest</span> will generate an error if it is not.
</div><div class="section-body-text">
The purpose of this option is to allow offline backups. The <span class="path">pg_xlog</span>/<span class="path">pg_wal</span> directory is copied as-is and <span class="br-setting">archive-check</span> is automatically disabled for the backup.
</div>
<pre class="code-block">default: y
example: --no-online</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-resume"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Resume Option (<span class="id">--resume</span>)
</div></div><div class="section-body"><div class="section-body-text">
Allow resume of failed backup.
</div><div class="section-body-text">
Defines whether the resume feature is enabled. Resume can greatly reduce the amount of time required to run a backup after a previous backup of the same type has failed. It adds complexity, however, so it may be desirable to disable in environments that do not require the feature.
</div>
<pre class="code-block">default: y
example: --no-resume</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-start-fast"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Start Fast Option (<span class="id">--start-fast</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force a checkpoint to start backup quickly.
</div><div class="section-body-text">
Forces a checkpoint (by passing <span class="id">y</span> to the <span class="id">fast</span> parameter of the backup start function) so the backup begins immediately. Otherwise the backup will start after the next regular checkpoint.
</div>
<pre class="code-block">default: n
example: --start-fast</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-stop-auto"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stop Auto Option (<span class="id">--stop-auto</span>)
</div></div><div class="section-body"><div class="section-body-text">
Stop prior failed backup on new backup.
</div><div class="section-body-text">
This will only be done if an exclusive advisory lock can be acquired to demonstrate that the prior failed backup process has really stopped.
</div><div class="section-body-text">
This feature is not supported for <span class="postgres">PostgreSQL</span> >= <span class="id">9.6</span> since backups are run in non-exclusive mode.
</div><div class="section-body-text">
The setting is disabled by default because it assumes that <span class="backrest">pgBackRest</span> is the only process doing exclusive online backups. It depends on an advisory lock that only <span class="backrest">pgBackRest</span> sets so it may abort other processes that do exclusive online backups. Note that <span class="cmd">base_backup</span> and <span class="cmd">pg_dump</span> are safe to use with this setting because they do not call <span class="id">pg_start_backup()</span> so are not exclusive.
</div>
<pre class="code-block">default: n
example: --stop-auto</pre>
</div></div><div class="section3"><a id="command-backup/category-command/option-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Type Option (<span class="id">--type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup type.
</div><div class="section-body-text">
The following backup types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">full</span> - all database cluster files will be copied and there will be no dependencies on previous backups.
</li><li class="list-unordered">
<span class="id">incr</span> - incremental from the last successful backup.
</li><li class="list-unordered">
<span class="id">diff</span> - like an incremental backup but always based on the last full backup.
</li></ul>
<pre class="code-block">default: incr
example: --type=full</pre>
</div></div></div></div><div class="section2"><a id="command-backup/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-compress"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Compress Option (<span class="id">--compress</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use file compression.
</div><div class="section-body-text">
Backup files are compatible with command-line compression tools.
</div><div class="section-body-text">
This option is now deprecated. The <span class="br-setting">compress-type</span> option should be used instead.
</div>
<pre class="code-block">default: y
example: --no-compress</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-compress-level"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Compress Level Option (<span class="id">--compress-level</span>)
</div></div><div class="section-body"><div class="section-body-text">
File compression level.
</div><div class="section-body-text">
Sets the level to be used for file compression when <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> or <span class="br-setting">compress=y</span> (deprecated).
</div><div class="section-body-text">
The following are the defaults levels based on <span class="br-setting">compress-type</span> when <span class="br-setting">compress-level</span> is not specified:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">bz2</span> - 9
</li><li class="list-unordered">
<span class="id">gz</span> - 6
</li><li class="list-unordered">
<span class="id">lz4</span> - 1
</li><li class="list-unordered">
<span class="id">zst</span> - 3
</li></ul>
<pre class="code-block">example: --compress-level=9</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-compress-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Compress Type Option (<span class="id">--compress-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
File compression type.
</div><div class="section-body-text">
The following compression types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - no compression
</li><li class="list-unordered">
<span class="id">bz2</span> - bzip2 compression format
</li><li class="list-unordered">
<span class="id">gz</span> - gzip compression format
</li><li class="list-unordered">
<span class="id">lz4</span> - lz4 compression format (not available on all platforms)
</li><li class="list-unordered">
<span class="id">zst</span> - Zstandard compression format (not available on all platforms)
</li></ul>
<pre class="code-block">default: gz
example: --compress-type=none</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-delta"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Delta Option (<span class="id">--delta</span>)
</div></div><div class="section-body"><div class="section-body-text">
Restore or backup using checksums.
</div><div class="section-body-text">
During a restore, by default the <span class="postgres">PostgreSQL</span> data and tablespace directories are expected to be present but empty. This option performs a delta restore using checksums.
</div><div class="section-body-text">
During a backup, this option will use checksums instead of the timestamps to determine if files will be copied.
</div>
<pre class="code-block">default: n
example: --delta</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Process Maximum Option (<span class="id">--process-max</span>)
</div></div><div class="section-body"><div class="section-body-text">
Max processes to use for compress/transfer.
</div><div class="section-body-text">
Each process will perform compression and transfer to make the command run faster, but don't set <span class="br-setting">process-max</span> so high that it impacts database performance.
</div>
<pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-backup/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-backup/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-backup/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-backup/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-backup/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-backup/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-backup/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-backup/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-maintainer/option-page-header-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Page Header Check Option (<span class="id">--page-header-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check PostgreSQL page headers.
</div><div class="section-body-text">
Enabled by default, this option adds page header checks.
</div><div class="section-body-text">
Disabling this option should be avoided except when necessary, e.g. if pages are encrypted.
</div>
<pre class="code-block">default: y
example: --no-page-header-check</pre>
</div></div><div class="section3"><a id="command-backup/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-backup/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-block"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Block Incremental Backup Option (<span class="id">--repo-block</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable block incremental backup.
</div><div class="section-body-text">
Block incremental allows for more granular backups by splitting files into blocks that can be backed up independently. This saves space in the repository and can improve delta restore performance because individual blocks can be fetched without reading the entire file from the repository.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">repo-bundle</span> option must be enabled before <span class="br-option">repo-block</span> can be enabled.
</div></div><div class="section-body-text">
The block size for a file is determined based on the file size and age. Generally, older/larger files will get larger block sizes. If a file is old enough, it will not be backed up using block incremental.
</div><div class="section-body-text">
Block incremental is most efficient when enabled for all backup types, including full. This makes the full a bit larger but subsequent differential and incremental backups can make use of the block maps generated by the full backup to save space.
</div>
<pre class="code-block">default: n
example: --repo1-block</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-bundle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Bundles Option (<span class="id">--repo-bundle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Bundle files in repository.
</div><div class="section-body-text">
Bundle (combine) smaller files to reduce the total number of files written to the repository. Writing fewer files is generally more efficient, especially on object stores such as <span class="host">S3</span>. In addition, zero-length files are not stored (except in the manifest), which saves time and space.
</div>
<pre class="code-block">default: n
example: --repo1-bundle</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-bundle-limit"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Bundle Limit Option (<span class="id">--repo-bundle-limit</span>)
</div></div><div class="section-body"><div class="section-body-text">
Limit for file bundles.
</div><div class="section-body-text">
Size limit for files that will be included in bundles. Files larger than this size will be stored separately.
</div><div class="section-body-text">
Bundled files cannot be reused when a backup is resumed, so this option controls the files that can be resumed, i.e. higher values result in fewer resumable files.
</div>
<pre class="code-block">default: 2MiB
allowed: 8KiB-1PiB
example: --repo1-bundle-limit=10MiB</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-bundle-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Bundle Size Option (<span class="id">--repo-bundle-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Target size for file bundles.
</div><div class="section-body-text">
Defines the total size of files that will be added to a single bundle. Most bundles will be smaller than this size but it is possible that some will be slightly larger, so do not set this option to the maximum size that your file system allows.
</div><div class="section-body-text">
In general, it is not a good idea to set this option too high because retries will need to redo the entire bundle.
</div>
<pre class="code-block">default: 20MiB
allowed: 1MiB-1PiB
example: --repo1-bundle-size=10MiB</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-hardlink"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Hardlink Option (<span class="id">--repo-hardlink</span>)
</div></div><div class="section-body"><div class="section-body-text">
Hardlink files between backups in the repository.
</div><div class="section-body-text">
Enable hard-linking of files in differential and incremental backups to their full backups. This gives the appearance that each backup is a full backup at the file-system level. Be careful, though, because modifying files that are hard-linked can affect all the backups in the set.
</div>
<pre class="code-block">default: n
example: --repo1-hardlink</pre>
<div class="section-body-text">
Deprecated Name: hardlink
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-archive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Retention Option (<span class="id">--repo-retention-archive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Number of backups worth of continuous WAL to retain.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
WAL segments required to make a backup consistent are always retained until the backup is expired regardless of how this option is configured.
</div></div><div class="section-body-text">
If this value is not set and <span class="br-setting">repo-retention-full-type</span> is <span class="br-setting">count</span> (default), then the archive to expire will default to the <span class="br-setting">repo-retention-full</span> (or <span class="br-setting">repo-retention-diff</span>) value corresponding to the <span class="br-setting">repo-retention-archive-type</span> if set to <span class="br-setting">full</span> (or <span class="br-setting">diff</span>). This will ensure that WAL is only expired for backups that are already expired. If <span class="br-setting">repo-retention-full-type</span> is <span class="br-setting">time</span>, then this value will default to removing archives that are earlier than the oldest full backup retained after satisfying the <span class="br-setting">repo-retention-full</span> setting.
</div><div class="section-body-text">
This option must be set if <span class="br-setting">repo-retention-archive-type</span> is set to <span class="br-setting">incr</span>. If disk space is at a premium, then this setting, in conjunction with <span class="br-setting">repo-retention-archive-type</span>, can be used to aggressively expire WAL segments. However, doing so negates the ability to perform PITR from the backups with expired WAL and is therefore <b>not</b> recommended.
</div>
<pre class="code-block">allowed: 1-9999999
example: --repo1-retention-archive=2</pre>
<div class="section-body-text">
Deprecated Name: retention-archive
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-archive-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Retention Type Option (<span class="id">--repo-retention-archive-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup type for WAL retention.
</div><div class="section-body-text">
If set to <span class="br-setting">full</span> <span class="backrest">pgBackRest</span> will keep archive logs for the number of full backups defined by <span class="br-setting">repo-retention-archive</span>. If set to <span class="br-setting">diff</span> (differential) <span class="backrest">pgBackRest</span> will keep archive logs for the number of full and differential backups defined by <span class="br-setting">repo-retention-archive</span>, meaning if the last backup taken was a full backup, it will be counted as a differential for the purpose of repo-retention. If set to <span class="br-setting">incr</span> (incremental) <span class="backrest">pgBackRest</span> will keep archive logs for the number of full, differential, and incremental backups defined by <span class="br-setting">repo-retention-archive</span>. It is recommended that this setting not be changed from the default which will only expire WAL in conjunction with expiring full backups.
</div>
<pre class="code-block">default: full
example: --repo1-retention-archive-type=diff</pre>
<div class="section-body-text">
Deprecated Name: retention-archive-type
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-diff"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Differential Retention Option (<span class="id">--repo-retention-diff</span>)
</div></div><div class="section-body"><div class="section-body-text">
Number of differential backups to retain.
</div><div class="section-body-text">
When a differential backup expires, all incremental backups associated with the differential backup will also expire. When not defined all differential backups will be kept until the full backups they depend on expire.
</div>
<pre class="code-block">allowed: 1-9999999
example: --repo1-retention-diff=3</pre>
<div class="section-body-text">
Deprecated Name: retention-diff
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-full"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Full Retention Option (<span class="id">--repo-retention-full</span>)
</div></div><div class="section-body"><div class="section-body-text">
Full backup retention count/time.
</div><div class="section-body-text">
When a full backup expires, all differential and incremental backups associated with the full backup will also expire. When the option is not defined a warning will be issued. If indefinite retention is desired then set the option to the max value.
</div>
<pre class="code-block">allowed: 1-9999999
example: --repo1-retention-full=2</pre>
<div class="section-body-text">
Deprecated Name: retention-full
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-full-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Full Retention Type Option (<span class="id">--repo-retention-full-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Retention type for full backups.
</div><div class="section-body-text">
Determines whether the <span class="br-setting">repo-retention-full</span> setting represents a time period (days) or count of full backups to keep. If set to <span class="br-setting">time</span> then full backups older than <span class="br-setting">repo-retention-full</span> will be removed from the repository if there is at least one backup that is equal to or greater than the <span class="br-setting">repo-retention-full</span> setting. For example, if <span class="br-setting">repo-retention-full</span> is 30 (days) and there are 2 full backups: one 25 days old and one 35 days old, no full backups will be expired because expiring the 35 day old backup would leave only the 25 day old backup, which would violate the 30 day retention policy of having at least one backup 30 days old before an older one can be expired. Archived WAL older than the oldest full backup remaining will be automatically expired unless <span class="br-setting">repo-retention-archive-type</span> and <span class="br-setting">repo-retention-archive</span> are explicitly set.
</div>
<pre class="code-block">default: count
example: --repo1-retention-full-type=time</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-history"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Backup History Retention Option (<span class="id">--repo-retention-history</span>)
</div></div><div class="section-body"><div class="section-body-text">
Days of backup history manifests to retain.
</div><div class="section-body-text">
A copy of the backup manifest is stored in the <span class="path">backup.history</span> path when a backup completes. By default these files are never expired since they are useful for data mining, e.g. measuring backup and WAL growth over time.
</div><div class="section-body-text">
Set <span class="br-setting">repo-retention-history</span> to define the number of days of backup history manifests to retain. Unexpired backups are always kept in the backup history. Specify <span class="br-option">repo-retention-history=0</span> to retain the backup history only for unexpired backups.
</div><div class="section-body-text">
When a full backup history manifest is expired, all differential and incremental backup history manifests associated with the full backup also expire.
</div>
<pre class="code-block">allowed: 0-9999999
example: --repo1-retention-history=365</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-backup/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-backup/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-stanza/option-pg-database"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database Option (<span class="id">--pg-database</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database.
</div><div class="section-body-text">
The database name used when connecting to <span class="postgres">PostgreSQL</span>. The default is usually best but some installations may not contain this database.
</div><div class="section-body-text">
Note that for legacy reasons the setting of the <span class="id">PGDATABASE</span> environment variable will be ignored.
</div>
<pre class="code-block">default: postgres
example: --pg1-database=backupdb</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Option (<span class="id">--pg-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host for operating remotely.
</div><div class="section-body-text">
Used for backups where the <span class="postgres">PostgreSQL</span> host is different from the repository host.
</div>
<pre class="code-block">example: --pg1-host=db.domain.com</pre>
<div class="section-body-text">
Deprecated Name: db-host
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority File Option (<span class="id">--pg-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority Path Option (<span class="id">--pg-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate File Option (<span class="id">--pg-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate file.
</div><div class="section-body-text">
Sent to <span class="postgres">PostgreSQL</span> host to prove client identity.
</div>
<pre class="code-block">example: --pg1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Command Option (<span class="id">--pg-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and <span class="postgres">PostgreSQL</span> hosts. If not defined, the <span class="postgres">PostgreSQL</span> host command will be set the same as the local command.
</div>
<pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: db-cmd
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Option (<span class="id">--pg-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: db-config
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Include Path Option (<span class="id">--pg-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Path Option (<span class="id">--pg-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --pg1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Key File Option (<span class="id">--pg-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --pg1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Port Option (<span class="id">--pg-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host port when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the <span class="postgres">PostgreSQL</span> host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: db-ssh-port
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Protocol Type Option (<span class="id">--pg-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --pg1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host User Option (<span class="id">--pg-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host logon user when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
This user will also own the remote <span class="backrest">pgBackRest</span> process and will initiate connections to <span class="postgres">PostgreSQL</span>. For this to work correctly the user should be the <span class="postgres">PostgreSQL</span> database cluster owner which is generally <span class="id">postgres</span>, the default.
</div>
<pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre>
<div class="section-body-text">
Deprecated Name: db-user
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Port Option (<span class="id">--pg-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> port.
</div><div class="section-body-text">
Port that <span class="postgres">PostgreSQL</span> is running on. This usually does not need to be specified as most <span class="postgres">PostgreSQL</span> clusters run on the default port.
</div>
<pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre>
<div class="section-body-text">
Deprecated Name: db-port
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Socket Path Option (<span class="id">--pg-socket-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> unix socket path.
</div><div class="section-body-text">
The unix socket directory that was specified when <span class="postgres">PostgreSQL</span> was started. <span class="backrest">pgBackRest</span> will automatically look in the standard location for your OS so there is usually no need to specify this setting unless the socket directory was explicitly modified with the <span class="br-setting">unix_socket_directory</span> setting in <span class="file">postgresql.conf</span>.
</div>
<pre class="code-block">example: --pg1-socket-path=/var/run/postgresql</pre>
<div class="section-body-text">
Deprecated Name: db-socket-path
</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database User Option (<span class="id">--pg-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database user.
</div><div class="section-body-text">
The database user name used when connecting to <span class="postgres">PostgreSQL</span>. If not specified <span class="backrest">pgBackRest</span> will connect with the local OS user or <span class="id">PGUSER</span>.
</div>
<pre class="code-block">example: --pg1-user=backupuser</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-check"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Check Command (<span class="id">check</span>)
</div></div><div class="section-body"><div class="section-body-text">
The <span class="cmd">check</span> command validates that <span class="backrest">pgBackRest</span> and the <span class="pg-setting">archive_command</span> setting are configured correctly for archiving and backups for the specified stanza. It will attempt to check all repositories and databases that are configured for the host on which the command is run. It detects misconfigurations, particularly in archiving, that result in incomplete backups because required WAL segments did not reach the archive. The command can be run on the <span class="postgres">PostgreSQL</span> or repository host. The command may also be run on the standby host, however, since <span class="id">pg_switch_xlog()</span>/<span class="id">pg_switch_wal()</span> cannot be performed on the standby, the command will only test the repository configuration.
</div><div class="section-body-text">
Note that <span class="id">pg_create_restore_point('pgBackRest Archive Check')</span> and <span class="id">pg_switch_xlog()</span>/<span class="id">pg_switch_wal()</span> are called to force <span class="postgres">PostgreSQL</span> to archive a WAL segment.
</div><div class="section2"><a id="command-check/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-check/category-command/option-archive-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Check Archive Option (<span class="id">--archive-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check that WAL segments are in the archive before backup completes.
</div><div class="section-body-text">
Checks that all WAL segments required to make the backup consistent are present in the WAL archive. It's a good idea to leave this as the default unless you are using another method for archiving.
</div><div class="section-body-text">
This option must be enabled if <span class="br-option">archive-copy</span> is enabled.
</div>
<pre class="code-block">default: y
example: --no-archive-check</pre>
</div></div><div class="section3"><a id="command-check/category-command/option-archive-mode-check"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Check Archive Mode Option (<span class="id">--archive-mode-check</span>)
</div></div><div class="section-body"><div class="section-body-text">
Check the <span class="postgres">PostgreSQL</span> <span class="br-setting">archive_mode</span> setting.
</div><div class="section-body-text">
Enabled by default, this option disallows <span class="postgres">PostgreSQL</span> <span class="br-setting">archive_mode=always</span>.
</div><div class="section-body-text">
WAL segments pushed from a standby server might be logically the same as WAL segments pushed from the primary but have different checksums. Disabling archiving from multiple sources is recommended to avoid conflicts.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
If this option is disabled then it is critical to ensure that only one archiver is writing to the repository via the <span class="cmd">archive-push</span> command.
</div></div>
<pre class="code-block">default: y
example: --no-archive-mode-check</pre>
</div></div><div class="section3"><a id="command-check/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Timeout Option (<span class="id">--archive-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Archive timeout.
</div><div class="section-body-text">
Set maximum time, in seconds, to wait for each WAL segment to reach the <span class="backrest">pgBackRest</span> archive repository. The timeout applies to the <span class="cmd">check</span> and <span class="cmd">backup</span> commands when waiting for WAL segments required for backup consistency to be archived.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1d
example: --archive-timeout=30</pre>
</div></div><div class="section3"><a id="command-check/category-command/option-backup-standby"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Backup from Standby Option (<span class="id">--backup-standby</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup from the standby cluster.
</div><div class="section-body-text">
Enable backup from standby to reduce load on the primary cluster. This option requires that both the <span class="host">primary</span> and <span class="host">standby</span> hosts be configured.
</div><div class="section-body-text">
The following modes are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">y</span> - Standby is required for backup.
</li><li class="list-unordered">
<span class="id">prefer</span> - Backup from standby if available otherwise backup from primary.
</li><li class="list-unordered">
<span class="id">n</span> - Backup from primary only.
</li></ul>
<pre class="code-block">default: n
example: --backup-standby=y</pre>
</div></div></div></div><div class="section2"><a id="command-check/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-check/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-check/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-check/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-check/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-check/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-check/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-check/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-check/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-check/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-check/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-check/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-check/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-check/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-check/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-check/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-check/category-stanza/option-pg-database"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database Option (<span class="id">--pg-database</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database.
</div><div class="section-body-text">
The database name used when connecting to <span class="postgres">PostgreSQL</span>. The default is usually best but some installations may not contain this database.
</div><div class="section-body-text">
Note that for legacy reasons the setting of the <span class="id">PGDATABASE</span> environment variable will be ignored.
</div>
<pre class="code-block">default: postgres
example: --pg1-database=backupdb</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Option (<span class="id">--pg-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host for operating remotely.
</div><div class="section-body-text">
Used for backups where the <span class="postgres">PostgreSQL</span> host is different from the repository host.
</div>
<pre class="code-block">example: --pg1-host=db.domain.com</pre>
<div class="section-body-text">
Deprecated Name: db-host
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority File Option (<span class="id">--pg-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority Path Option (<span class="id">--pg-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate File Option (<span class="id">--pg-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate file.
</div><div class="section-body-text">
Sent to <span class="postgres">PostgreSQL</span> host to prove client identity.
</div>
<pre class="code-block">example: --pg1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Command Option (<span class="id">--pg-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and <span class="postgres">PostgreSQL</span> hosts. If not defined, the <span class="postgres">PostgreSQL</span> host command will be set the same as the local command.
</div>
<pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: db-cmd
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Option (<span class="id">--pg-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: db-config
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Include Path Option (<span class="id">--pg-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Path Option (<span class="id">--pg-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --pg1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Key File Option (<span class="id">--pg-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --pg1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Port Option (<span class="id">--pg-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host port when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the <span class="postgres">PostgreSQL</span> host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: db-ssh-port
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Protocol Type Option (<span class="id">--pg-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --pg1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host User Option (<span class="id">--pg-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host logon user when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
This user will also own the remote <span class="backrest">pgBackRest</span> process and will initiate connections to <span class="postgres">PostgreSQL</span>. For this to work correctly the user should be the <span class="postgres">PostgreSQL</span> database cluster owner which is generally <span class="id">postgres</span>, the default.
</div>
<pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre>
<div class="section-body-text">
Deprecated Name: db-user
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Port Option (<span class="id">--pg-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> port.
</div><div class="section-body-text">
Port that <span class="postgres">PostgreSQL</span> is running on. This usually does not need to be specified as most <span class="postgres">PostgreSQL</span> clusters run on the default port.
</div>
<pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre>
<div class="section-body-text">
Deprecated Name: db-port
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Socket Path Option (<span class="id">--pg-socket-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> unix socket path.
</div><div class="section-body-text">
The unix socket directory that was specified when <span class="postgres">PostgreSQL</span> was started. <span class="backrest">pgBackRest</span> will automatically look in the standard location for your OS so there is usually no need to specify this setting unless the socket directory was explicitly modified with the <span class="br-setting">unix_socket_directory</span> setting in <span class="file">postgresql.conf</span>.
</div>
<pre class="code-block">example: --pg1-socket-path=/var/run/postgresql</pre>
<div class="section-body-text">
Deprecated Name: db-socket-path
</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database User Option (<span class="id">--pg-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database user.
</div><div class="section-body-text">
The database user name used when connecting to <span class="postgres">PostgreSQL</span>. If not specified <span class="backrest">pgBackRest</span> will connect with the local OS user or <span class="id">PGUSER</span>.
</div>
<pre class="code-block">example: --pg1-user=backupuser</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-expire"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Expire Command (<span class="id">expire</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> does full backup rotation based on the retention type which can be a count or a time period. When a count is specified, then expiration is not concerned with when the backups were created but with how many must be retained. Differential and Incremental backups are count-based but will always be expired when the backup they depend on is expired. See sections <a href="user-guide.html#retention/full">Full Backup Retention</a> and <a href="user-guide.html#retention/diff">Differential Backup Retention</a> for details and examples. Archived WAL is retained by default for backups that have not expired, however, although not recommended, this schedule can be modified per repository with the retention-archive options. See section <a href="user-guide.html#retention/archive">Archive Retention</a> for details and examples.
</div><div class="section-body-text">
The <span class="cmd">expire</span> command is run automatically after each successful backup and can also be run by the user. When run by the user, expiration will occur as defined by the retention settings for each configured repository. If the <span class="br-option">--repo</span> option is provided, expiration will occur only on the specified repository. Expiration can also be limited by the user to a specific backup set with the <span class="br-option">--set</span> option and, unless the <span class="br-option">--repo</span> option is specified, all repositories will be searched and any matching the set criteria will be expired. It should be noted that the archive retention schedule will be checked and performed any time the <span class="cmd">expire</span> command is run.
</div><div class="section2"><a id="command-expire/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-command/option-set"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Option (<span class="id">--set</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup set to expire.
</div><div class="section-body-text">
The specified backup set (i.e. the backup label provided and all of its dependent backups, if any) will be expired regardless of backup retention rules except that at least one full backup must remain in the repository.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Use this option with extreme caution &mdash; it will permanently remove all backups and archives not required to make a backup consistent from the <span class="backrest">pgBackRest</span> repository for the specified backup set. This process may negate the ability to perform PITR. If <span class="br-option">--repo-retention-full</span> and/or <span class="br-option">--repo-retention-archive</span> options are configured, then it is recommended that you override these options by setting their values to the maximum while performing ad hoc expiration in order to prevent an unintended expiration of archives.
</div></div>
<pre class="code-block">example: --set=20150131-153358F_20150131-153401I</pre>
</div></div></div></div><div class="section2"><a id="command-expire/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-dry-run"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Dry Run Option (<span class="id">--dry-run</span>)
</div></div><div class="section-body"><div class="section-body-text">
Execute a dry-run for the command.
</div><div class="section-body-text">
The <span class="br-option">--dry-run</span> option is a command-line only option and can be passed when it is desirable to determine what modifications will be made by the command without the command actually making any modifications.
</div>
<pre class="code-block">default: n
example: --dry-run</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-expire/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-expire/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-expire/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-expire/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-expire/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-expire/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-expire/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-archive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Retention Option (<span class="id">--repo-retention-archive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Number of backups worth of continuous WAL to retain.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
WAL segments required to make a backup consistent are always retained until the backup is expired regardless of how this option is configured.
</div></div><div class="section-body-text">
If this value is not set and <span class="br-setting">repo-retention-full-type</span> is <span class="br-setting">count</span> (default), then the archive to expire will default to the <span class="br-setting">repo-retention-full</span> (or <span class="br-setting">repo-retention-diff</span>) value corresponding to the <span class="br-setting">repo-retention-archive-type</span> if set to <span class="br-setting">full</span> (or <span class="br-setting">diff</span>). This will ensure that WAL is only expired for backups that are already expired. If <span class="br-setting">repo-retention-full-type</span> is <span class="br-setting">time</span>, then this value will default to removing archives that are earlier than the oldest full backup retained after satisfying the <span class="br-setting">repo-retention-full</span> setting.
</div><div class="section-body-text">
This option must be set if <span class="br-setting">repo-retention-archive-type</span> is set to <span class="br-setting">incr</span>. If disk space is at a premium, then this setting, in conjunction with <span class="br-setting">repo-retention-archive-type</span>, can be used to aggressively expire WAL segments. However, doing so negates the ability to perform PITR from the backups with expired WAL and is therefore <b>not</b> recommended.
</div>
<pre class="code-block">allowed: 1-9999999
example: --repo1-retention-archive=2</pre>
<div class="section-body-text">
Deprecated Name: retention-archive
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-archive-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Retention Type Option (<span class="id">--repo-retention-archive-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup type for WAL retention.
</div><div class="section-body-text">
If set to <span class="br-setting">full</span> <span class="backrest">pgBackRest</span> will keep archive logs for the number of full backups defined by <span class="br-setting">repo-retention-archive</span>. If set to <span class="br-setting">diff</span> (differential) <span class="backrest">pgBackRest</span> will keep archive logs for the number of full and differential backups defined by <span class="br-setting">repo-retention-archive</span>, meaning if the last backup taken was a full backup, it will be counted as a differential for the purpose of repo-retention. If set to <span class="br-setting">incr</span> (incremental) <span class="backrest">pgBackRest</span> will keep archive logs for the number of full, differential, and incremental backups defined by <span class="br-setting">repo-retention-archive</span>. It is recommended that this setting not be changed from the default which will only expire WAL in conjunction with expiring full backups.
</div>
<pre class="code-block">default: full
example: --repo1-retention-archive-type=diff</pre>
<div class="section-body-text">
Deprecated Name: retention-archive-type
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-diff"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Differential Retention Option (<span class="id">--repo-retention-diff</span>)
</div></div><div class="section-body"><div class="section-body-text">
Number of differential backups to retain.
</div><div class="section-body-text">
When a differential backup expires, all incremental backups associated with the differential backup will also expire. When not defined all differential backups will be kept until the full backups they depend on expire.
</div>
<pre class="code-block">allowed: 1-9999999
example: --repo1-retention-diff=3</pre>
<div class="section-body-text">
Deprecated Name: retention-diff
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-full"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Full Retention Option (<span class="id">--repo-retention-full</span>)
</div></div><div class="section-body"><div class="section-body-text">
Full backup retention count/time.
</div><div class="section-body-text">
When a full backup expires, all differential and incremental backups associated with the full backup will also expire. When the option is not defined a warning will be issued. If indefinite retention is desired then set the option to the max value.
</div>
<pre class="code-block">allowed: 1-9999999
example: --repo1-retention-full=2</pre>
<div class="section-body-text">
Deprecated Name: retention-full
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-full-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Full Retention Type Option (<span class="id">--repo-retention-full-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Retention type for full backups.
</div><div class="section-body-text">
Determines whether the <span class="br-setting">repo-retention-full</span> setting represents a time period (days) or count of full backups to keep. If set to <span class="br-setting">time</span> then full backups older than <span class="br-setting">repo-retention-full</span> will be removed from the repository if there is at least one backup that is equal to or greater than the <span class="br-setting">repo-retention-full</span> setting. For example, if <span class="br-setting">repo-retention-full</span> is 30 (days) and there are 2 full backups: one 25 days old and one 35 days old, no full backups will be expired because expiring the 35 day old backup would leave only the 25 day old backup, which would violate the 30 day retention policy of having at least one backup 30 days old before an older one can be expired. Archived WAL older than the oldest full backup remaining will be automatically expired unless <span class="br-setting">repo-retention-archive-type</span> and <span class="br-setting">repo-retention-archive</span> are explicitly set.
</div>
<pre class="code-block">default: count
example: --repo1-retention-full-type=time</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-history"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Backup History Retention Option (<span class="id">--repo-retention-history</span>)
</div></div><div class="section-body"><div class="section-body-text">
Days of backup history manifests to retain.
</div><div class="section-body-text">
A copy of the backup manifest is stored in the <span class="path">backup.history</span> path when a backup completes. By default these files are never expired since they are useful for data mining, e.g. measuring backup and WAL growth over time.
</div><div class="section-body-text">
Set <span class="br-setting">repo-retention-history</span> to define the number of days of backup history manifests to retain. Unexpired backups are always kept in the backup history. Specify <span class="br-option">repo-retention-history=0</span> to retain the backup history only for unexpired backups.
</div><div class="section-body-text">
When a full backup history manifest is expired, all differential and incremental backup history manifests associated with the full backup also expire.
</div>
<pre class="code-block">allowed: 0-9999999
example: --repo1-retention-history=365</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-expire/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-help"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Help Command (<span class="id">help</span>)
</div></div><div class="section-body"><div class="section-body-text">
Three levels of help are provided. If no command is specified then general help will be displayed. If a command is specified (e.g. <span class="cmd">pgbackrest help backup</span>) then a full description of the command will be displayed along with a list of valid options. If an option is specified in addition to a command (e.g. <span class="cmd">pgbackrest help backup type</span>) then a full description of the option as it applies to the command will be displayed.
</div><div class="section2"><a id="command-help/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-help/category-command/option-help"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Display Help Option (<span class="id">--help</span>)
</div></div><div class="section-body"><div class="section-body-text">
Display help.
</div><div class="section-body-text">
Displays help even if the <span class="cmd">help</span> command is not specified and overrides the <span class="br-option">--version</span> option.
</div>
<pre class="code-block">default: n
example: --help</pre>
</div></div><div class="section3"><a id="command-help/category-command/option-version"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Display Version Option (<span class="id">--version</span>)
</div></div><div class="section-body"><div class="section-body-text">
Display version.
</div><div class="section-body-text">
Displays version even if the <span class="cmd">version</span> or <span class="cmd">help</span> command is not specified.
</div>
<pre class="code-block">default: n
example: --version</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-info"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Info Command (<span class="id">info</span>)
</div></div><div class="section-body"><div class="section-body-text">
The <span class="cmd">info</span> command operates on a single stanza or all stanzas. Text output is the default and gives a human-readable summary of backups for the stanza(s) requested. This format is subject to change with any release.
</div><div class="section-body-text">
For machine-readable output use <span class="br-option">--output=json</span>. The JSON output contains far more information than the text output and is kept stable unless a bug is found.
</div><div class="section-body-text">
Each stanza has a separate section and it is possible to limit output to a single stanza with the <span class="br-option">--stanza</span> option. The stanza '<span class="id">status</span>' gives a brief indication of the stanza's health. If this is '<span class="id">ok</span>' then <span class="backrest">pgBackRest</span> is functioning normally. If there are multiple repositories, then a status of '<span class="id">mixed</span>' indicates that the stanza is not in a healthy state on one or more of the repositories; in this case the state of the stanza will be detailed per repository. For cases in which an error on a repository occurred that is not one of the known error codes, then an error code of '<span class="id">other</span>' will be used and the full error details will be provided. The '<span class="id">wal archive min/max</span>' shows the minimum and maximum WAL currently stored in the archive and, in the case of multiple repositories, will be reported across all repositories unless the <span class="br-option">--repo</span> option is set. Note that there may be gaps due to archive retention policies or other reasons.
</div><div class="section-body-text">
The '<span class="id">backup/expire running</span>' message will appear beside the '<span class="id">status</span>' information if one of those commands is currently running on the host.
</div><div class="section-body-text">
The backups are displayed oldest to newest. The oldest backup will <i>always</i> be a full backup (indicated by an <span class="id">F</span> at the end of the label) but the newest backup can be full, differential (ends with <span class="id">D</span>), or incremental (ends with <span class="id">I</span>).
</div><div class="section-body-text">
The '<span class="id">timestamp start/stop</span>' defines the time period when the backup ran. The '<span class="id">timestamp stop</span>' can be used to determine the backup to use when performing Point-In-Time Recovery. More information about Point-In-Time Recovery can be found in the <a href="user-guide.html#pitr">Point-In-Time Recovery</a> section.
</div><div class="section-body-text">
The '<span class="id">wal start/stop</span>' defines the WAL range that is required to make the database consistent when restoring. The <span class="cmd">backup</span> command will ensure that this WAL range is in the archive before completing.
</div><div class="section-body-text">
The '<span class="id">database size</span>' is the full uncompressed size of the database while '<span class="id">database backup size</span>' is the amount of data in the database to actually back up (these will be the same for full backups).
</div><div class="section-body-text">
The '<span class="id">repo</span>' indicates in which repository this backup resides. The '<span class="id">backup set size</span>' includes all the files from this backup and any referenced backups in the repository that are required to restore the database from this backup while '<span class="id">backup size</span>' includes only the files in this backup (these will also be the same for full backups). Repository sizes reflect compressed file sizes if compression is enabled in <span class="backrest">pgBackRest</span>.
</div><div class="section-body-text">
The '<span class="id">backup reference total</span>' summarizes the list of additional backups that are required to restore this backup. Use the <span class="br-option">--set</span> option to display the complete reference list.
</div><div class="section2"><a id="command-info/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-info/category-command/option-output"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Output Option (<span class="id">--output</span>)
</div></div><div class="section-body"><div class="section-body-text">
Output format.
</div><div class="section-body-text">
The following output types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">text</span> - Human-readable summary of backup information.
</li><li class="list-unordered">
<span class="id">json</span> - Exhaustive machine-readable backup information in JSON format.
</li></ul>
<pre class="code-block">default: text
example: --output=json</pre>
</div></div><div class="section3"><a id="command-info/category-command/option-set"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Option (<span class="id">--set</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup set to detail.
</div><div class="section-body-text">
Details include a complete list of additional backups that are required to restore this backup, a list of databases (with OIDs) in the backup set (excluding template databases), tablespaces (with OIDs) with the destination where they will be restored by default, and symlinks with the destination where they will be restored when <span class="br-setting">--link-all</span> is specified.
</div>
<pre class="code-block">example: --set=20150131-153358F_20150131-153401I</pre>
</div></div><div class="section3"><a id="command-info/category-command/option-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Type Option (<span class="id">--type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Filter on backup type.
</div><div class="section-body-text">
Filter the output using one of the following backup types: <span class="id">full</span>, <span class="id">incr</span>, <span class="id">diff</span>.
</div>
<pre class="code-block">example: --type=full</pre>
</div></div></div></div><div class="section2"><a id="command-info/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-info/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-info/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-info/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-info/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-info/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-info/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-info/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-info/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-info/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-info/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-info/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-target-time"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Time for Repository Option (<span class="id">--repo-target-time</span>)
</div></div><div class="section-body"><div class="section-body-text">
Target time for repository.
</div><div class="section-body-text">
The target time defines the time that commands use to read a repository on versioned storage. This allows the command to read the repository as it was at a point-in-time in order to recover data that has been deleted or corrupted by user accident or malware.
</div><div class="section-body-text">
Versioned storage is supported by <span class="host">S3</span>, <span class="host">GCS</span>, and <span class="host">Azure</span> but is generally not enabled by default. In addition to enabling versioning, it may be useful to enable object locking for <span class="host">S3</span> and soft delete for <span class="host">GCS</span> or <span class="host">Azure</span>.
</div><div class="section-body-text">
When the <span class="br-option">repo-target-time</span> option is specified then the <span class="br-option">repo</span> option must also be provided. It is likely that not all repository types will support versioning and in general it makes sense to target a single repository for recovery.
</div><div class="section-body-text">
Note that comparisons to the storage timestamp are <= the timestamp provided and milliseconds are truncated from the timestamp when provided.
</div>
<pre class="code-block">example: --repo-target-time=2024-08-08 12:12:12+00</pre>
</div></div><div class="section3"><a id="command-info/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-repo-get"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Repository Get Command (<span class="id">repo-get</span>)
</div></div><div class="section-body"><div class="section-body-text">
Similar to the unix <span class="cmd">cat</span> command but works on any supported repository type. This command requires a fully qualified file name and is primarily for administration, investigation, and testing. It is not a required part of a normal <span class="backrest">pgBackRest</span> setup.
</div><div class="section-body-text">
If the repository is encrypted then <span class="cmd">repo-get</span> will automatically decrypt the file. Files are not automatically decompressed but the output can be piped through the appropriate decompression command, e.g. <span class="id">gzip -d</span>.
</div><div class="section-body-text">
If more than one repository is configured, the command will default to the highest priority repository (e.g. <span class="id">repo1</span>) unless the <span class="br-option">--repo</span> option is specified.
</div><div class="section2"><a id="command-repo-get/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-command/option-ignore-missing"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Ignore Missing Option (<span class="id">--ignore-missing</span>)
</div></div><div class="section-body"><div class="section-body-text">
Ignore missing source file.
</div><div class="section-body-text">
Exit with 1 if the source file is missing but don't throw an error.
</div>
<pre class="code-block">default: n
example: --ignore-missing</pre>
</div></div></div></div><div class="section2"><a id="command-repo-get/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-raw"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Raw Data Option (<span class="id">--raw</span>)
</div></div><div class="section-body"><div class="section-body-text">
Do not transform data.
</div><div class="section-body-text">
Do not transform (i.e, encrypt, decompress, etc.) data for the current command.
</div>
<pre class="code-block">default: n
example: --raw</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-repo-get/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-repo-get/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-repo-get/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-repo-get/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-repo-get/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-repo-get/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-repo-get/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-repo-get/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-target-time"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Time for Repository Option (<span class="id">--repo-target-time</span>)
</div></div><div class="section-body"><div class="section-body-text">
Target time for repository.
</div><div class="section-body-text">
The target time defines the time that commands use to read a repository on versioned storage. This allows the command to read the repository as it was at a point-in-time in order to recover data that has been deleted or corrupted by user accident or malware.
</div><div class="section-body-text">
Versioned storage is supported by <span class="host">S3</span>, <span class="host">GCS</span>, and <span class="host">Azure</span> but is generally not enabled by default. In addition to enabling versioning, it may be useful to enable object locking for <span class="host">S3</span> and soft delete for <span class="host">GCS</span> or <span class="host">Azure</span>.
</div><div class="section-body-text">
When the <span class="br-option">repo-target-time</span> option is specified then the <span class="br-option">repo</span> option must also be provided. It is likely that not all repository types will support versioning and in general it makes sense to target a single repository for recovery.
</div><div class="section-body-text">
Note that comparisons to the storage timestamp are <= the timestamp provided and milliseconds are truncated from the timestamp when provided.
</div>
<pre class="code-block">example: --repo-target-time=2024-08-08 12:12:12+00</pre>
</div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-repo-ls"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Repository List Command (<span class="id">repo-ls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Similar to the unix <span class="cmd">ls</span> command but works on any supported repository type. This command accepts a path, absolute or relative to the repository path defined by the <span class="br-option">--repo-path</span> option, and is primarily for administration, investigation, and testing. It is not a required part of a normal <span class="backrest">pgBackRest</span> setup.
</div><div class="section-body-text">
The default text output prints one file name per line. JSON output is available by specifying <span class="br-option">--output=json</span>.
</div><div class="section-body-text">
If more than one repository is configured, the command will default to the highest priority repository (e.g. <span class="id">repo1</span>) unless the <span class="br-option">--repo</span> option is specified.
</div><div class="section2"><a id="command-repo-ls/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-command/option-filter"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Filter Output Option (<span class="id">--filter</span>)
</div></div><div class="section-body"><div class="section-body-text">
Filter output with a regular expression.
</div><div class="section-body-text">
The filter is applied against the file/path names before they are output.
</div>
<pre class="code-block">example: --filter="(F|D|I)$"</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-command/option-output"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Output Option (<span class="id">--output</span>)
</div></div><div class="section-body"><div class="section-body-text">
Output format.
</div><div class="section-body-text">
The following output types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">text</span> - Simple list with one file/link/path name on each line.
</li><li class="list-unordered">
<span class="id">json</span> - Detailed file/link/path information in JSON format.
</li></ul><div class="section-body-text">
In JSON format the available fields are:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">name</span> - file/link/path name (and partial path when recursing).
</li><li class="list-unordered">
<span class="id">type</span> - <span class="id">file</span>, <span class="id">path</span>, or <span class="id">link</span>.
</li><li class="list-unordered">
<span class="id">size</span> - size in bytes (files only).
</li><li class="list-unordered">
<span class="id">time</span> - time last modified (files only).
</li><li class="list-unordered">
<span class="id">destination</span> - link destination (links only).
</li></ul>
<pre class="code-block">default: text
example: --output=json</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-command/option-recurse"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Recurse Subpaths Option (<span class="id">--recurse</span>)
</div></div><div class="section-body"><div class="section-body-text">
Include all subpaths in output.
</div><div class="section-body-text">
All subpaths and their files will be included in the output.
</div>
<pre class="code-block">default: n
example: --recurse</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-command/option-sort"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Sort Output Option (<span class="id">--sort</span>)
</div></div><div class="section-body"><div class="section-body-text">
Sort output ascending, descending, or none.
</div><div class="section-body-text">
The following sort types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">asc</span> - sort ascending.
</li><li class="list-unordered">
<span class="id">desc</span> - sort descending.
</li><li class="list-unordered">
<span class="id">none</span> - no sorting.
</li></ul>
<pre class="code-block">default: asc
example: --sort=desc</pre>
</div></div></div></div><div class="section2"><a id="command-repo-ls/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-repo-ls/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-repo-ls/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-target-time"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Time for Repository Option (<span class="id">--repo-target-time</span>)
</div></div><div class="section-body"><div class="section-body-text">
Target time for repository.
</div><div class="section-body-text">
The target time defines the time that commands use to read a repository on versioned storage. This allows the command to read the repository as it was at a point-in-time in order to recover data that has been deleted or corrupted by user accident or malware.
</div><div class="section-body-text">
Versioned storage is supported by <span class="host">S3</span>, <span class="host">GCS</span>, and <span class="host">Azure</span> but is generally not enabled by default. In addition to enabling versioning, it may be useful to enable object locking for <span class="host">S3</span> and soft delete for <span class="host">GCS</span> or <span class="host">Azure</span>.
</div><div class="section-body-text">
When the <span class="br-option">repo-target-time</span> option is specified then the <span class="br-option">repo</span> option must also be provided. It is likely that not all repository types will support versioning and in general it makes sense to target a single repository for recovery.
</div><div class="section-body-text">
Note that comparisons to the storage timestamp are <= the timestamp provided and milliseconds are truncated from the timestamp when provided.
</div>
<pre class="code-block">example: --repo-target-time=2024-08-08 12:12:12+00</pre>
</div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-restore"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Restore Command (<span class="id">restore</span>)
</div></div><div class="section-body"><div class="section-body-text">
The restore command automatically defaults to selecting the latest backup from the first repository where backups exist (see <a href="user-guide.html#quickstart/perform-restore">Quick Start - Restore a Backup</a>). The order in which the repositories are checked is dictated by the <span class="file">pgbackrest.conf</span> (e.g. repo1 will be checked before repo2). To select from a specific repository, the <span class="br-option">--repo</span> option can be passed (e.g. <span class="br-option">--repo=1</span>). The <span class="br-option">--set</span> option can be passed if a backup other than the latest is desired.
</div><div class="section-body-text">
When PITR of <span class="br-option">--type=time</span> or <span class="br-option">--type=lsn</span> is specified, then the target time or target lsn must be specified with the <span class="br-option">--target</span> option. If a backup is not specified via the <span class="br-option">--set</span> option, then the configured repositories will be checked, in order, for a backup that contains the requested time or lsn. If no matching backup is found, the latest backup from the first repository containing backups will be used for <span class="br-option">--type=time</span> while no backup will be selected for <span class="br-option">--type=lsn</span>. For other types of PITR, e.g. <span class="id">xid</span>, the <span class="br-option">--set</span> option must be provided if the target is prior to the latest backup. See <a href="user-guide.html#pitr">Point-in-Time Recovery</a> for more details and examples.
</div><div class="section-body-text">
Replication slots are not included per recommendation of <span class="postgres">PostgreSQL</span>. See <a href="https://www.postgresql.org/docs/current/continuous-archiving.html#BACKUP-LOWLEVEL-BASE-BACKUP-DATA">Backing Up The Data Directory</a> in the <span class="postgres">PostgreSQL</span> documentation for more information.
</div><div class="section2"><a id="command-restore/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-command/option-archive-mode"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Archive Mode Option (<span class="id">--archive-mode</span>)
</div></div><div class="section-body"><div class="section-body-text">
Preserve or disable archiving on restored cluster.
</div><div class="section-body-text">
This option allows archiving to be preserved or disabled on a restored cluster. This is useful when the cluster must be promoted to do some work but is not intended to become the new primary. In this case it is not a good idea to push WAL from the cluster into the repository.
</div><div class="section-body-text">
The following modes are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - disable archiving by setting <span class="br-setting">archive_mode=off</span>.
</li><li class="list-unordered">
<span class="id">preserve</span> - preserve current <span class="br-setting">archive_mode</span> setting.
</li></ul><div class="section-body-text">
<b>NOTE</b>: This option is not available on <span class="postgres">PostgreSQL</span> &lt; 12.
</div>
<pre class="code-block">default: preserve
example: --archive-mode=off</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-db-exclude"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Exclude Database Option (<span class="id">--db-exclude</span>)
</div></div><div class="section-body"><div class="section-body-text">
Restore excluding the specified databases.
</div><div class="section-body-text">
Databases excluded will be restored as sparse, zeroed files to save space but still allow <span class="postgres">PostgreSQL</span> to perform recovery. After recovery, those databases will not be accessible but can be removed with the <span class="id">drop database</span> command. The <span class="br-setting">--db-exclude</span> option can be passed multiple times to specify more than one database to exclude.
</div><div class="section-body-text">
When used in combination with the <span class="br-setting">--db-include</span> option, <span class="br-setting">--db-exclude</span> will only apply to standard system databases (<span class="id">template0</span>, <span class="id">template1</span>, and <span class="id">postgres</span>).
</div>
<pre class="code-block">example: --db-exclude=db_main</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-db-include"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Include Database Option (<span class="id">--db-include</span>)
</div></div><div class="section-body"><div class="section-body-text">
Restore only specified databases.
</div><div class="section-body-text">
This feature allows only selected databases to be restored. Databases not specifically included will be restored as sparse, zeroed files to save space but still allow <span class="postgres">PostgreSQL</span> to perform recovery. After recovery, the databases that were not included will not be accessible but can be removed with the <span class="id">drop database</span> command.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
built-in databases (<span class="id">template0</span>, <span class="id">template1</span>, and <span class="id">postgres</span>) are always restored unless specifically excluded.
</div></div><div class="section-body-text">
The <span class="br-setting">--db-include</span> option can be passed multiple times to specify more than one database to include.
</div><div class="section-body-text">
See <a href="user-guide.html#restore/option-db-include">Restore Selected Databases</a> for additional information and caveats.
</div>
<pre class="code-block">example: --db-include=db_main</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force Option (<span class="id">--force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force a restore.
</div><div class="section-body-text">
By itself this option forces the <span class="postgres">PostgreSQL</span> data and tablespace paths to be completely overwritten. In combination with <span class="br-option">--delta</span> a timestamp/size delta will be performed instead of using checksums.
</div>
<pre class="code-block">default: n
example: --force</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-link-all"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Link All Option (<span class="id">--link-all</span>)
</div></div><div class="section-body"><div class="section-body-text">
Restore all symlinks.
</div><div class="section-body-text">
By default symlinked directories and files are restored as normal directories and files in $PGDATA. This is because it may not be safe to restore symlinks to their original destinations on a system other than where the original backup was performed. This option restores all the symlinks just as they were on the original system where the backup was performed.
</div>
<pre class="code-block">default: n
example: --link-all</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-link-map"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Link Map Option (<span class="id">--link-map</span>)
</div></div><div class="section-body"><div class="section-body-text">
Modify the destination of a symlink.
</div><div class="section-body-text">
Allows the destination file or path of a symlink to be changed on restore. This is useful for restoring to systems that have a different storage layout than the original system where the backup was generated.
</div>
<pre class="code-block">example: --link-map=pg_xlog=/data/xlog</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-recovery-option"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Recovery Option Option (<span class="id">--recovery-option</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set an option in <span class="file">postgresql.auto.conf</span> or <span class="file">recovery.conf</span>.
</div><div class="section-body-text">
See <a href="https://www.postgresql.org/docs/current/runtime-config.html">Server Configuration</a> for details on <span class="file">postgresql.auto.conf</span> or <span class="file">recovery.conf</span> options (be sure to select your <span class="postgres">PostgreSQL</span> version). This option can be used multiple times.
</div><div class="section-body-text">
For <span class="postgres">PostgreSQL</span> >= 12, options will be written into <span class="file">postgresql.auto.conf</span>. For all other versions, options will be written into <span class="file">recovery.conf</span>.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-setting">restore_command</span> option will be automatically generated but can be overridden with this option. Be careful about specifying your own <span class="br-setting">restore_command</span> as <span class="backrest">pgBackRest</span> is designed to handle this for you. Target Recovery options (recovery_target_name, recovery_target_time, etc.) are generated automatically by <span class="backrest">pgBackRest</span> and should not be set with this option.
</div></div><div class="section-body-text">
Since <span class="backrest">pgBackRest</span> does not start <span class="postgres">PostgreSQL</span> after writing the <span class="file">postgresql.auto.conf</span> or <span class="file">recovery.conf</span> file, it is always possible to edit/check <span class="file">postgresql.auto.conf</span> or <span class="file">recovery.conf</span> before manually restarting.
</div>
<pre class="code-block">example: --recovery-option=primary_conninfo=db.mydomain.com</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-set"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Option (<span class="id">--set</span>)
</div></div><div class="section-body"><div class="section-body-text">
Backup set to restore.
</div><div class="section-body-text">
The backup set to be restored. <span class="id">latest</span> will restore the latest backup, otherwise provide the name of the backup to restore.
</div>
<pre class="code-block">default: latest
example: --set=20150131-153358F_20150131-153401I</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-tablespace-map"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Tablespace Map Option (<span class="id">--tablespace-map</span>)
</div></div><div class="section-body"><div class="section-body-text">
Restore a tablespace into the specified directory.
</div><div class="section-body-text">
Moves a tablespace to a new location during the restore. This is useful when tablespace locations are not the same on a replica, or an upgraded system has different mount points.
</div><div class="section-body-text">
Tablespace locations are not stored in pg_tablespace so moving tablespaces can be done with impunity. However, moving a tablespace to the <span class="br-setting">data_directory</span> is not recommended and may cause problems. For more information on moving tablespaces http://www.databasesoup.com/2013/11/moving-tablespaces.html is a good resource.
</div>
<pre class="code-block">example: --tablespace-map=ts_01=/db/ts_01</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-tablespace-map-all"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Map All Tablespaces Option (<span class="id">--tablespace-map-all</span>)
</div></div><div class="section-body"><div class="section-body-text">
Restore all tablespaces into the specified directory.
</div><div class="section-body-text">
Tablespaces are restored into their original locations by default. This behavior can be modified for each tablespace with the <span class="br-setting">tablespace-map</span> option, but it is sometimes preferable to remap all tablespaces to a new directory all at once. This is particularly useful for development or staging systems that may not have the same storage layout as the original system where the backup was generated.
</div><div class="section-body-text">
The path specified will be the parent path used to create all the tablespaces in the backup.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Tablespaces created after the backup started will not be mapped. Make a new backup after a tablespace is created if tablespace mapping is required.
</div></div>
<pre class="code-block">example: --tablespace-map-all=/data/tablespace</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-target"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Option (<span class="id">--target</span>)
</div></div><div class="section-body"><div class="section-body-text">
Recovery target.
</div><div class="section-body-text">
Defines the recovery target when <span class="br-option">--type</span> is <span class="id">lsn</span>, <span class="id">name</span>, <span class="id">xid</span>, or <span class="id">time</span>. If the target is prior to the latest backup and <span class="br-option">--type</span> is not <span class="id">time</span> or <span class="id">lsn</span>, then use the <span class="br-option">--set</span> option to specify the backup set.
</div>
<pre class="code-block">example: --target=2015-01-30 14:15:11 EST</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-target-action"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Action Option (<span class="id">--target-action</span>)
</div></div><div class="section-body"><div class="section-body-text">
Action to take when recovery target is reached.
</div><div class="section-body-text">
When <span class="br-setting">hot_standby=on</span>, the default since <span class="postgres">PostgreSQL</span> 10, this option consistently controls what the cluster does when the target is reached or there is no more WAL in the archive.
</div><div class="section-body-text">
When <span class="br-setting">hot_standby=off</span> in <span class="postgres">PostgreSQL</span> >= 12, <span class="id">pause</span> acts like <span class="id">shutdown</span>. When <span class="br-setting">hot_standby=off</span> in <span class="postgres">PostgreSQL</span> < 12, <span class="id">pause</span> acts like <span class="id">promote</span>.
</div><div class="section-body-text">
The following actions are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">pause</span> - pause when recovery target is reached.
</li><li class="list-unordered">
<span class="id">promote</span> - promote and switch timeline when recovery target is reached.
</li><li class="list-unordered">
<span class="id">shutdown</span> - shutdown server when recovery target is reached. (<span class="postgres">PostgreSQL</span> >= 9.5)
</li></ul>
<pre class="code-block">default: pause
example: --target-action=promote</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-target-exclusive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Exclusive Option (<span class="id">--target-exclusive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Stop just before the recovery target is reached.
</div><div class="section-body-text">
Defines whether recovery to the target would be exclusive (the default is inclusive) and is only valid when <span class="br-option">--type</span> is <span class="id">lsn</span>, <span class="id">time</span> or <span class="id">xid</span>. For example, using <span class="br-option">--target-exclusive</span> would exclude the contents of transaction <span class="id">1007</span> when <span class="br-option">--type=xid</span> and <span class="br-option">--target=1007</span>. See the <span class="br-setting">recovery_target_inclusive</span> option in the <span class="postgres">PostgreSQL</span> docs for more information.
</div>
<pre class="code-block">default: n
example: --no-target-exclusive</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-target-timeline"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Timeline Option (<span class="id">--target-timeline</span>)
</div></div><div class="section-body"><div class="section-body-text">
Recover along a timeline.
</div><div class="section-body-text">
See <span class="br-setting">recovery_target_timeline</span> in the <span class="postgres">PostgreSQL</span> docs for more information.
</div>
<pre class="code-block">example: --target-timeline=3</pre>
</div></div><div class="section3"><a id="command-restore/category-command/option-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Type Option (<span class="id">--type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Recovery type.
</div><div class="section-body-text">
The following recovery types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">default</span> - recover to the end of the archive stream.
</li><li class="list-unordered">
<span class="id">immediate</span> - recover only until the database becomes consistent. This option is only supported on <span class="postgres">PostgreSQL</span> >= 9.4.
</li><li class="list-unordered">
<span class="id">lsn</span> - recover to the LSN (Log Sequence Number) specified in <span class="br-option">--target</span>. This option is only supported on <span class="postgres">PostgreSQL</span> >= 10.
</li><li class="list-unordered">
<span class="id">name</span> - recover the restore point specified in <span class="br-option">--target</span>.
</li><li class="list-unordered">
<span class="id">xid</span> - recover to the transaction id specified in <span class="br-option">--target</span>.
</li><li class="list-unordered">
<span class="id">time</span> - recover to the time specified in <span class="br-option">--target</span>.
</li><li class="list-unordered">
<span class="id">preserve</span> - preserve the existing <span class="file">postgresql.auto.conf</span> or <span class="file">recovery.conf</span> file.
</li><li class="list-unordered">
<span class="id">standby</span> - add <span class="br-setting">standby_mode=on</span> to the <span class="file">postgresql.auto.conf</span> or <span class="file">recovery.conf</span> file so cluster will start in standby mode.
</li><li class="list-unordered">
<span class="id">none</span> - no <span class="file">postgresql.auto.conf</span> or <span class="file">recovery.conf</span> file is written so <span class="postgres">PostgreSQL</span> will attempt to achieve consistency using WAL segments present in <span class="path">pg_xlog</span>/<span class="path">pg_wal</span>. Provide the required WAL segments or use the <span class="br-setting">archive-copy</span> setting to include them with the backup.
</li></ul><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Recovery <span class="br-option">type=none</span> should be avoided because the timeline will not be incremented at the end of recovery. This can lead to, for example, <span class="postgres">PostgreSQL</span> attempting to archive duplicate WAL, which will be rejected, and may cause the disk to fill up and result in a <span class="postgres">PostgreSQL</span> panic. In addition, tools like <span class="id">pg_rewind</span> may not work correctly or may cause corruption.
</div></div><div class="section-body-text">
Note that the default restore <span class="br-option">type</span> for offline backups is <span class="id">none</span> since Point-in-Time-Recovery is not possible if <span class="br-setting">wal_level=minimal</span>. If <span class="br-option">type</span> is set explicitly then it will be honored since Point-in-Time-Recovery is possible from offline backups as long as <span class="br-setting">wal_level > minimal</span>.
</div>
<pre class="code-block">default: default
example: --type=xid</pre>
</div></div></div></div><div class="section2"><a id="command-restore/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-delta"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Delta Option (<span class="id">--delta</span>)
</div></div><div class="section-body"><div class="section-body-text">
Restore or backup using checksums.
</div><div class="section-body-text">
During a restore, by default the <span class="postgres">PostgreSQL</span> data and tablespace directories are expected to be present but empty. This option performs a delta restore using checksums.
</div><div class="section-body-text">
During a backup, this option will use checksums instead of the timestamps to determine if files will be copied.
</div>
<pre class="code-block">default: n
example: --delta</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Process Maximum Option (<span class="id">--process-max</span>)
</div></div><div class="section-body"><div class="section-body-text">
Max processes to use for compress/transfer.
</div><div class="section-body-text">
Each process will perform compression and transfer to make the command run faster, but don't set <span class="br-setting">process-max</span> so high that it impacts database performance.
</div>
<pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-restore/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-restore/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-restore/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-restore/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-restore/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-restore/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-restore/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-restore/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-restore/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-target-time"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Time for Repository Option (<span class="id">--repo-target-time</span>)
</div></div><div class="section-body"><div class="section-body-text">
Target time for repository.
</div><div class="section-body-text">
The target time defines the time that commands use to read a repository on versioned storage. This allows the command to read the repository as it was at a point-in-time in order to recover data that has been deleted or corrupted by user accident or malware.
</div><div class="section-body-text">
Versioned storage is supported by <span class="host">S3</span>, <span class="host">GCS</span>, and <span class="host">Azure</span> but is generally not enabled by default. In addition to enabling versioning, it may be useful to enable object locking for <span class="host">S3</span> and soft delete for <span class="host">GCS</span> or <span class="host">Azure</span>.
</div><div class="section-body-text">
When the <span class="br-option">repo-target-time</span> option is specified then the <span class="br-option">repo</span> option must also be provided. It is likely that not all repository types will support versioning and in general it makes sense to target a single repository for recovery.
</div><div class="section-body-text">
Note that comparisons to the storage timestamp are <= the timestamp provided and milliseconds are truncated from the timestamp when provided.
</div>
<pre class="code-block">example: --repo-target-time=2024-08-08 12:12:12+00</pre>
</div></div><div class="section3"><a id="command-restore/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-restore/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div></div></div></div></div><div class="section1"><a id="command-server"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Server Command (<span class="id">server</span>)
</div></div><div class="section-body"><div class="section-body-text">
The <span class="backrest">pgBackRest</span> server allows access to remote hosts without using the <span class="host">SSH</span> protocol.
</div><div class="section2"><a id="command-server/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-server/category-command/option-tls-server-address"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Address Option (<span class="id">--tls-server-address</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server address.
</div><div class="section-body-text">
IP address the server will listen on for client requests.
</div>
<pre class="code-block">default: localhost
example: --tls-server-address=*</pre>
</div></div><div class="section3"><a id="command-server/category-command/option-tls-server-auth"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Authorized Clients Option (<span class="id">--tls-server-auth</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server authorized clients.
</div><div class="section-body-text">
Clients are authorized on the server by verifying their certificate and checking their certificate CN (Common Name) against a list on the server configured with the <span class="br-option">tls-server-auth</span> option.
</div><div class="section-body-text">
A client CN can be authorized for as many stanzas as needed by repeating the <span class="br-option">tls-server-auth</span> option, or for all stanzas by specifying <span class="br-option">tls-server-auth=client-cn=*</span>. Wildcards may not be specified for the client CN.
</div>
<pre class="code-block">example: --tls-server-auth=client-cn=stanza1</pre>
</div></div><div class="section3"><a id="command-server/category-command/option-tls-server-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Certificate Authorities Option (<span class="id">--tls-server-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server certificate authorities.
</div><div class="section-body-text">
Checks that client certificates are signed by a trusted certificate authority.
</div>
<pre class="code-block">example: --tls-server-ca-file=/path/to/server.ca</pre>
</div></div><div class="section3"><a id="command-server/category-command/option-tls-server-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Certificate Option (<span class="id">--tls-server-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server certificate file.
</div><div class="section-body-text">
Sent to the client to show the server identity.
</div>
<pre class="code-block">example: --tls-server-cert-file=/path/to/server.crt</pre>
</div></div><div class="section3"><a id="command-server/category-command/option-tls-server-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Key Option (<span class="id">--tls-server-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server key file.
</div><div class="section-body-text">
Proves server certificate was sent by the owner.
</div>
<pre class="code-block">example: --tls-server-key-file=/path/to/server.key</pre>
</div></div><div class="section3"><a id="command-server/category-command/option-tls-server-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Port Option (<span class="id">--tls-server-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server port.
</div><div class="section-body-text">
Port the server will listen on for client requests.
</div>
<pre class="code-block">default: 8432
allowed: 1-65535
example: --tls-server-port=8000</pre>
</div></div></div></div><div class="section2"><a id="command-server/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-server/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-server/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-server/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-server/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-server/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-server/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-server/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-server/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-server-ping"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Server Ping Command (<span class="id">server-ping</span>)
</div></div><div class="section-body"><div class="section-body-text">
Ping a <span class="backrest">pgBackRest</span> <span class="host">TLS</span> server to ensure it is accepting connections. This serves as an aliveness check only since no authentication is attempted.
</div><div class="section-body-text">
If no host is specified on the command-line then the <span class="br-option">tls-server-host</span> option will be used.
</div><div class="section2"><a id="command-server-ping/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-server-ping/category-command/option-tls-server-address"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Address Option (<span class="id">--tls-server-address</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server address.
</div><div class="section-body-text">
IP address the server will listen on for client requests.
</div>
<pre class="code-block">default: localhost
example: --tls-server-address=*</pre>
</div></div><div class="section3"><a id="command-server-ping/category-command/option-tls-server-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
TLS Server Port Option (<span class="id">--tls-server-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
TLS server port.
</div><div class="section-body-text">
Port the server will listen on for client requests.
</div>
<pre class="code-block">default: 8432
allowed: 1-65535
example: --tls-server-port=8000</pre>
</div></div></div></div><div class="section2"><a id="command-server-ping/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-server-ping/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-server-ping/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-server-ping/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-server-ping/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-server-ping/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-server-ping/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-server-ping/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-server-ping/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-stanza-create"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Stanza Create Command (<span class="id">stanza-create</span>)
</div></div><div class="section-body"><div class="section-body-text">
The <span class="cmd">stanza-create</span> command must be run after the stanza has been configured in <span class="file">pgbackrest.conf</span>. If there is more than one repository configured, the stanza will be created on each. Stanzas that have already been created will be skipped so it is always safe to run <span class="cmd">stanza-create</span>, even when a new repository has been configured.
</div><div class="section-body-text">
See <a href="user-guide.html#quickstart/create-stanza">Create the Stanza</a> for more information and an example.
</div><div class="section2"><a id="command-stanza-create/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-command/option-online"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Online Option (<span class="id">--online</span>)
</div></div><div class="section-body"><div class="section-body-text">
Create on an online cluster.
</div><div class="section-body-text">
Specifying --no-online prevents <span class="backrest">pgBackRest</span> from connecting to <span class="postgres">PostgreSQL</span> when creating the stanza.
</div>
<pre class="code-block">default: y
example: --no-online</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-create/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-create/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-create/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-create/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-create/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-database"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database Option (<span class="id">--pg-database</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database.
</div><div class="section-body-text">
The database name used when connecting to <span class="postgres">PostgreSQL</span>. The default is usually best but some installations may not contain this database.
</div><div class="section-body-text">
Note that for legacy reasons the setting of the <span class="id">PGDATABASE</span> environment variable will be ignored.
</div>
<pre class="code-block">default: postgres
example: --pg1-database=backupdb</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Option (<span class="id">--pg-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host for operating remotely.
</div><div class="section-body-text">
Used for backups where the <span class="postgres">PostgreSQL</span> host is different from the repository host.
</div>
<pre class="code-block">example: --pg1-host=db.domain.com</pre>
<div class="section-body-text">
Deprecated Name: db-host
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority File Option (<span class="id">--pg-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority Path Option (<span class="id">--pg-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate File Option (<span class="id">--pg-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate file.
</div><div class="section-body-text">
Sent to <span class="postgres">PostgreSQL</span> host to prove client identity.
</div>
<pre class="code-block">example: --pg1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Command Option (<span class="id">--pg-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and <span class="postgres">PostgreSQL</span> hosts. If not defined, the <span class="postgres">PostgreSQL</span> host command will be set the same as the local command.
</div>
<pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: db-cmd
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Option (<span class="id">--pg-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: db-config
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Include Path Option (<span class="id">--pg-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Path Option (<span class="id">--pg-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --pg1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Key File Option (<span class="id">--pg-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --pg1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Port Option (<span class="id">--pg-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host port when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the <span class="postgres">PostgreSQL</span> host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: db-ssh-port
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Protocol Type Option (<span class="id">--pg-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --pg1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host User Option (<span class="id">--pg-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host logon user when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
This user will also own the remote <span class="backrest">pgBackRest</span> process and will initiate connections to <span class="postgres">PostgreSQL</span>. For this to work correctly the user should be the <span class="postgres">PostgreSQL</span> database cluster owner which is generally <span class="id">postgres</span>, the default.
</div>
<pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre>
<div class="section-body-text">
Deprecated Name: db-user
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Port Option (<span class="id">--pg-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> port.
</div><div class="section-body-text">
Port that <span class="postgres">PostgreSQL</span> is running on. This usually does not need to be specified as most <span class="postgres">PostgreSQL</span> clusters run on the default port.
</div>
<pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre>
<div class="section-body-text">
Deprecated Name: db-port
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Socket Path Option (<span class="id">--pg-socket-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> unix socket path.
</div><div class="section-body-text">
The unix socket directory that was specified when <span class="postgres">PostgreSQL</span> was started. <span class="backrest">pgBackRest</span> will automatically look in the standard location for your OS so there is usually no need to specify this setting unless the socket directory was explicitly modified with the <span class="br-setting">unix_socket_directory</span> setting in <span class="file">postgresql.conf</span>.
</div>
<pre class="code-block">example: --pg1-socket-path=/var/run/postgresql</pre>
<div class="section-body-text">
Deprecated Name: db-socket-path
</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database User Option (<span class="id">--pg-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database user.
</div><div class="section-body-text">
The database user name used when connecting to <span class="postgres">PostgreSQL</span>. If not specified <span class="backrest">pgBackRest</span> will connect with the local OS user or <span class="id">PGUSER</span>.
</div>
<pre class="code-block">example: --pg1-user=backupuser</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-stanza-delete"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Stanza Delete Command (<span class="id">stanza-delete</span>)
</div></div><div class="section-body"><div class="section-body-text">
The <span class="cmd">stanza-delete</span> command removes data in the repository associated with a stanza.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Use this command with caution &mdash; it will permanently remove all backups and archives from the <span class="backrest">pgBackRest</span> repository for the specified stanza.
</div></div><div class="section-body-text">
To delete a stanza:
</div><ul class="list-unordered"><li class="list-unordered">
Shut down the <span class="postgres">PostgreSQL</span> cluster associated with the stanza (or use --force to override).
</li><li class="list-unordered">
Run the <span class="cmd">stop</span> command on the host where the <span class="cmd">stanza-delete</span> command will be run.
</li><li class="list-unordered">
Run the <span class="cmd">stanza-delete</span> command.
</li></ul><div class="section-body-text">
Once the command successfully completes, it is the responsibility of the user to remove the stanza from all <span class="backrest">pgBackRest</span> configuration files and/or environment variables.
</div><div class="section-body-text">
A stanza may only be deleted from one repository at a time. To delete the stanza from multiple repositories, repeat the <span class="cmd">stanza-delete</span> command for each repository while specifying the <span class="br-option">--repo</span> option.
</div><div class="section2"><a id="command-stanza-delete/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-command/option-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force Option (<span class="id">--force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force stanza delete.
</div><div class="section-body-text">
If <span class="postgres">PostgreSQL</span> is still running for the stanza, then this option can be used to force the stanza to be deleted from the repository.
</div>
<pre class="code-block">default: n
example: --no-force</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-delete/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-delete/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-delete/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-delete/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-delete/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-database"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database Option (<span class="id">--pg-database</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database.
</div><div class="section-body-text">
The database name used when connecting to <span class="postgres">PostgreSQL</span>. The default is usually best but some installations may not contain this database.
</div><div class="section-body-text">
Note that for legacy reasons the setting of the <span class="id">PGDATABASE</span> environment variable will be ignored.
</div>
<pre class="code-block">default: postgres
example: --pg1-database=backupdb</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Option (<span class="id">--pg-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host for operating remotely.
</div><div class="section-body-text">
Used for backups where the <span class="postgres">PostgreSQL</span> host is different from the repository host.
</div>
<pre class="code-block">example: --pg1-host=db.domain.com</pre>
<div class="section-body-text">
Deprecated Name: db-host
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority File Option (<span class="id">--pg-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority Path Option (<span class="id">--pg-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate File Option (<span class="id">--pg-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate file.
</div><div class="section-body-text">
Sent to <span class="postgres">PostgreSQL</span> host to prove client identity.
</div>
<pre class="code-block">example: --pg1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Command Option (<span class="id">--pg-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and <span class="postgres">PostgreSQL</span> hosts. If not defined, the <span class="postgres">PostgreSQL</span> host command will be set the same as the local command.
</div>
<pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: db-cmd
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Option (<span class="id">--pg-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: db-config
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Include Path Option (<span class="id">--pg-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Path Option (<span class="id">--pg-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --pg1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Key File Option (<span class="id">--pg-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --pg1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Port Option (<span class="id">--pg-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host port when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the <span class="postgres">PostgreSQL</span> host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: db-ssh-port
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Protocol Type Option (<span class="id">--pg-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --pg1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host User Option (<span class="id">--pg-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host logon user when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
This user will also own the remote <span class="backrest">pgBackRest</span> process and will initiate connections to <span class="postgres">PostgreSQL</span>. For this to work correctly the user should be the <span class="postgres">PostgreSQL</span> database cluster owner which is generally <span class="id">postgres</span>, the default.
</div>
<pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre>
<div class="section-body-text">
Deprecated Name: db-user
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Port Option (<span class="id">--pg-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> port.
</div><div class="section-body-text">
Port that <span class="postgres">PostgreSQL</span> is running on. This usually does not need to be specified as most <span class="postgres">PostgreSQL</span> clusters run on the default port.
</div>
<pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre>
<div class="section-body-text">
Deprecated Name: db-port
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Socket Path Option (<span class="id">--pg-socket-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> unix socket path.
</div><div class="section-body-text">
The unix socket directory that was specified when <span class="postgres">PostgreSQL</span> was started. <span class="backrest">pgBackRest</span> will automatically look in the standard location for your OS so there is usually no need to specify this setting unless the socket directory was explicitly modified with the <span class="br-setting">unix_socket_directory</span> setting in <span class="file">postgresql.conf</span>.
</div>
<pre class="code-block">example: --pg1-socket-path=/var/run/postgresql</pre>
<div class="section-body-text">
Deprecated Name: db-socket-path
</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database User Option (<span class="id">--pg-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database user.
</div><div class="section-body-text">
The database user name used when connecting to <span class="postgres">PostgreSQL</span>. If not specified <span class="backrest">pgBackRest</span> will connect with the local OS user or <span class="id">PGUSER</span>.
</div>
<pre class="code-block">example: --pg1-user=backupuser</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-stanza-upgrade"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Stanza Upgrade Command (<span class="id">stanza-upgrade</span>)
</div></div><div class="section-body"><div class="section-body-text">
Immediately after upgrading <span class="postgres">PostgreSQL</span> to a newer major version, the <span class="br-option">pg-path</span> for all <span class="backrest">pgBackRest</span> configurations must be set to the new database location and the <span class="cmd">stanza-upgrade</span> command run. If there is more than one repository configured on the host, the stanza will be upgraded on each. If the database is offline use the <span class="br-option">--no-online</span> option.
</div><div class="section2"><a id="command-stanza-upgrade/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-command/option-online"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Online Option (<span class="id">--online</span>)
</div></div><div class="section-body"><div class="section-body-text">
Update an online cluster.
</div><div class="section-body-text">
Specifying --no-online prevents <span class="backrest">pgBackRest</span> from connecting to <span class="postgres">PostgreSQL</span> when upgrading the stanza.
</div>
<pre class="code-block">default: y
example: --no-online</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Database Timeout Option (<span class="id">--db-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Database query timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, for queries against the database. This includes the backup start/stop functions which can each take a substantial amount of time. Because of this the timeout should be kept high unless you know that these functions will return quickly (i.e. if you have set <span class="br-setting">start-fast=y</span> and you know that the database cluster will not generate many WAL segments during the backup).
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">db-timeout</span> option must be less than the <span class="br-option">protocol-timeout</span> option.
</div></div>
<pre class="code-block">default: 30m
allowed: 100ms-7d
example: --db-timeout=600</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-stanza"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Stanza Options
</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-database"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database Option (<span class="id">--pg-database</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database.
</div><div class="section-body-text">
The database name used when connecting to <span class="postgres">PostgreSQL</span>. The default is usually best but some installations may not contain this database.
</div><div class="section-body-text">
Note that for legacy reasons the setting of the <span class="id">PGDATABASE</span> environment variable will be ignored.
</div>
<pre class="code-block">default: postgres
example: --pg1-database=backupdb</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Option (<span class="id">--pg-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host for operating remotely.
</div><div class="section-body-text">
Used for backups where the <span class="postgres">PostgreSQL</span> host is different from the repository host.
</div>
<pre class="code-block">example: --pg1-host=db.domain.com</pre>
<div class="section-body-text">
Deprecated Name: db-host
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority File Option (<span class="id">--pg-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate Authority Path Option (<span class="id">--pg-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the <span class="postgres">PostgreSQL</span> host.
</div>
<pre class="code-block">example: --pg1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Certificate File Option (<span class="id">--pg-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host certificate file.
</div><div class="section-body-text">
Sent to <span class="postgres">PostgreSQL</span> host to prove client identity.
</div>
<pre class="code-block">example: --pg1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Command Option (<span class="id">--pg-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and <span class="postgres">PostgreSQL</span> hosts. If not defined, the <span class="postgres">PostgreSQL</span> host command will be set the same as the local command.
</div>
<pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: db-cmd
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Option (<span class="id">--pg-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: db-config
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Include Path Option (<span class="id">--pg-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Configuration Path Option (<span class="id">--pg-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> database host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the <span class="postgres">PostgreSQL</span> host. This is only required if the <span class="postgres">PostgreSQL</span> host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --pg1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Key File Option (<span class="id">--pg-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --pg1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Port Option (<span class="id">--pg-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host port when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the <span class="postgres">PostgreSQL</span> host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: db-ssh-port
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host Protocol Type Option (<span class="id">--pg-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --pg1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Host User Option (<span class="id">--pg-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> host logon user when <span class="br-setting">pg-host</span> is set.
</div><div class="section-body-text">
This user will also own the remote <span class="backrest">pgBackRest</span> process and will initiate connections to <span class="postgres">PostgreSQL</span>. For this to work correctly the user should be the <span class="postgres">PostgreSQL</span> database cluster owner which is generally <span class="id">postgres</span>, the default.
</div>
<pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre>
<div class="section-body-text">
Deprecated Name: db-user
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Path Option (<span class="id">--pg-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> data directory.
</div><div class="section-body-text">
This should be the same as the <span class="br-setting">data_directory</span> reported by <span class="postgres">PostgreSQL</span>. Even though this value can be read from various places, it is prudent to set it in case those resources are not available during a restore or offline backup scenario.
</div><div class="section-body-text">
The <span class="br-setting">pg-path</span> option is tested against the value reported by <span class="postgres">PostgreSQL</span> on every online backup so it should always be current.
</div>
<pre class="code-block">example: --pg1-path=/data/db</pre>
<div class="section-body-text">
Deprecated Name: db-path
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Port Option (<span class="id">--pg-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> port.
</div><div class="section-body-text">
Port that <span class="postgres">PostgreSQL</span> is running on. This usually does not need to be specified as most <span class="postgres">PostgreSQL</span> clusters run on the default port.
</div>
<pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre>
<div class="section-body-text">
Deprecated Name: db-port
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Socket Path Option (<span class="id">--pg-socket-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> unix socket path.
</div><div class="section-body-text">
The unix socket directory that was specified when <span class="postgres">PostgreSQL</span> was started. <span class="backrest">pgBackRest</span> will automatically look in the standard location for your OS so there is usually no need to specify this setting unless the socket directory was explicitly modified with the <span class="br-setting">unix_socket_directory</span> setting in <span class="file">postgresql.conf</span>.
</div>
<pre class="code-block">example: --pg1-socket-path=/var/run/postgresql</pre>
<div class="section-body-text">
Deprecated Name: db-socket-path
</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
PostgreSQL Database User Option (<span class="id">--pg-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="postgres">PostgreSQL</span> database user.
</div><div class="section-body-text">
The database user name used when connecting to <span class="postgres">PostgreSQL</span>. If not specified <span class="backrest">pgBackRest</span> will connect with the local OS user or <span class="id">PGUSER</span>.
</div>
<pre class="code-block">example: --pg1-user=backupuser</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-start"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Start Command (<span class="id">start</span>)
</div></div><div class="section-body"><div class="section-body-text">
If the <span class="backrest">pgBackRest</span> processes were previously stopped using the <span class="cmd">stop</span> command then they can be started again using the <span class="cmd">start</span> command. Note that this will not immediately start up any <span class="backrest">pgBackRest</span> processes but they are allowed to run. See <a href="user-guide.html#start-stop">Starting and Stopping</a> for more information and examples.
</div><div class="section2"><a id="command-start/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-start/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-start/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-start/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-start/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-start/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-start/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div></div></div><div class="section2"><a id="command-start/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-start/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-start/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-start/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-start/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-start/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-stop"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Stop Command (<span class="id">stop</span>)
</div></div><div class="section-body"><div class="section-body-text">
Does not allow any new <span class="backrest">pgBackRest</span> processes to run. By default running processes will be allowed to complete successfully. Use the <span class="br-setting">--force</span> option to terminate running processes.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> processes will return an error if they are run after the stop command completes. See <a href="user-guide.html#start-stop">Starting and Stopping</a> for more information and examples.
</div><div class="section2"><a id="command-stop/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-command/option-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force Option (<span class="id">--force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force all <span class="backrest">pgBackRest</span> processes to stop.
</div><div class="section-body-text">
This option will send TERM signals to all running <span class="backrest">pgBackRest</span> processes to effect a graceful but immediate shutdown. Note that this will also shutdown processes that were initiated on another system but have remotes running on the current system. For instance, if a backup was started on the backup server then running <span class="cmd">stop --force</span> on the database server will shutdown the backup process on the backup server.
</div>
<pre class="code-block">default: n
example: --force</pre>
</div></div></div></div><div class="section2"><a id="command-stop/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-stop/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-stop/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-stop/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Lock Path Option (<span class="id">--lock-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where lock files are stored.
</div><div class="section-body-text">
The lock path provides a location for <span class="backrest">pgBackRest</span> to create lock files to prevent conflicting operations from being run concurrently.
</div>
<pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre>
</div></div><div class="section3"><a id="command-stop/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-stop/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div></div></div><div class="section2"><a id="command-stop/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-stop/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-stop/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-stop/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-stop/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-verify"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Verify Command (<span class="id">verify</span>)
</div></div><div class="section-body"><div class="section-body-text">
Verify determines if the backups and archives in the repository are valid.
</div><div class="section2"><a id="command-verify/category-command"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Command Options
</div></div><div class="section-body"><div class="section3"><a id="command-verify/category-command/option-output"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Output Option (<span class="id">--output</span>)
</div></div><div class="section-body"><div class="section-body-text">
Output type.
</div><div class="section-body-text">
Output may be none (default) or text. Requesting text generates output to stdout.
</div>
<pre class="code-block">default: none
example: --output=text</pre>
</div></div><div class="section3"><a id="command-verify/category-command/option-verbose"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Verbose Option (<span class="id">--verbose</span>)
</div></div><div class="section-body"><div class="section-body-text">
Verbose output.
</div><div class="section-body-text">
Verbose defaults to false, providing a minimal response with important information about errors in the repository. Specifying true provides more information about what was successfully verified.
</div>
<pre class="code-block">default: n
example: --verbose</pre>
</div></div></div></div><div class="section2"><a id="command-verify/category-general"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
General Options
</div></div><div class="section-body"><div class="section3"><a id="command-verify/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Buffer Size Option (<span class="id">--buffer-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Buffer size for I/O operations.
</div><div class="section-body-text">
Buffer size used for copy, compress, encrypt, and other operations. The number of buffers used depends on options and each operation may use additional memory, e.g. <span class="id">gz</span> compression may use an additional 256KiB of memory.
</div><div class="section-body-text">
Allowed values are <span class="id">16KiB</span>, <span class="id">32KiB</span>, <span class="id">64KiB</span>, <span class="id">128KiB</span>, <span class="id">256KiB</span>, <span class="id">512KiB</span>, <span class="id">1MiB</span>, <span class="id">2MiB</span>, <span class="id">4MiB</span>, <span class="id">8MiB</span>, and <span class="id">16MiB</span>.
</div>
<pre class="code-block">default: 1MiB
example: --buffer-size=2MiB</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
pgBackRest Command Option (<span class="id">--cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> may generate a command string, e.g. when the <span class="cmd">restore</span> command generates the <span class="pg-setting">restore_command</span> setting. The command used to run the <span class="backrest">pgBackRest</span> process will be used in this case unless the <span class="br-option">cmd</span> option is provided.
</div><div class="admonition"><div class="caution">
CAUTION:
</div><div class="caution-text">
Wrapping the <span class="backrest">pgBackRest</span> command may cause unpredictable behavior and is not recommended.
</div></div>
<pre class="code-block">example: --cmd=/var/lib/pgsql/bin/pgbackrest_wrapper.sh</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SSH Client Command Option (<span class="id">--cmd-ssh</span>)
</div></div><div class="section-body"><div class="section-body-text">
SSH client command.
</div><div class="section-body-text">
Use a specific SSH client command when an alternate is desired or the <span class="file">ssh</span> command is not in $PATH.
</div>
<pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Network Compress Level Option (<span class="id">--compress-level-network</span>)
</div></div><div class="section-body"><div class="section-body-text">
Network compression level.
</div><div class="section-body-text">
Sets the network compression level when <span class="br-setting">compress-type=none</span> and the command is not run on the same host as the repository. Compression is used to reduce network traffic but can be disabled by setting <span class="br-setting">compress-level-network=0</span>. When <span class="br-setting">compress-type</span> does not equal <span class="id">none</span> the <span class="br-setting">compress-level-network</span> setting is ignored and <span class="br-setting">compress-level</span> is used instead so that the file is only compressed once.
</div>
<pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Option (<span class="id">--config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> configuration file.
</div><div class="section-body-text">
Use this option to specify a different configuration file than the default.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --config=/conf/pgbackrest/pgbackrest.conf</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Include Path Option (<span class="id">--config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path to additional <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
Configuration files existing in the specified location with extension <span class="file">.conf</span> will be concatenated with the <span class="backrest">pgBackRest</span> configuration file, resulting in one configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Config Path Option (<span class="id">--config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Base path of <span class="backrest">pgBackRest</span> configuration files.
</div><div class="section-body-text">
This setting is used to override the default base path setting for the <span class="br-option">--config</span> and <span class="br-option">--config-include-path</span> options unless they are explicitly set on the command-line.
</div><div class="section-body-text">
For example, passing only <span class="id">--config-path=/conf/pgbackrest</span> results in the <span class="br-option">--config</span> default being set to <span class="id">/conf/pgbackrest/pgbackrest.conf</span> and the <span class="br-option">--config-include-path</span> default being set to <span class="id">/conf/pgbackrest/conf.d</span>.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
I/O Timeout Option (<span class="id">--io-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
I/O timeout.
</div><div class="section-body-text">
Timeout, in seconds, used for connections and read/write operations.
</div><div class="section-body-text">
Note that the entire read/write operation does not need to complete within this timeout but <i>some</i> progress must be made, even if it is only a single byte.
</div>
<pre class="code-block">default: 1m
allowed: 100ms-1h
example: --io-timeout=120</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Neutral Umask Option (<span class="id">--neutral-umask</span>)
</div></div><div class="section-body"><div class="section-body-text">
Use a neutral umask.
</div><div class="section-body-text">
Sets the umask to 0000 so modes in the repository are created in a sensible way. The default directory mode is 0750 and default file mode is 0640. The lock and log directories set the directory and file mode to 0770 and 0660 respectively.
</div><div class="section-body-text">
To use the executing user's umask instead specify <span class="br-setting">neutral-umask=n</span> in the config file or <span class="br-setting">--no-neutral-umask</span> on the command line.
</div>
<pre class="code-block">default: y
example: --no-neutral-umask</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Process Maximum Option (<span class="id">--process-max</span>)
</div></div><div class="section-body"><div class="section-body-text">
Max processes to use for compress/transfer.
</div><div class="section-body-text">
Each process will perform compression and transfer to make the command run faster, but don't set <span class="br-setting">process-max</span> so high that it impacts database performance.
</div>
<pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Protocol Timeout Option (<span class="id">--protocol-timeout</span>)
</div></div><div class="section-body"><div class="section-body-text">
Protocol timeout.
</div><div class="section-body-text">
Sets the timeout, in seconds, that the local or remote process will wait for a new message to be received on the protocol layer. This prevents processes from waiting indefinitely for a message.
</div><div class="admonition"><div class="note">
NOTE:
</div><div class="note-text">
The <span class="br-option">protocol-timeout</span> option must be greater than the <span class="br-option">db-timeout</span> option.
</div></div>
<pre class="code-block">default: 31m
allowed: 100ms-7d
example: --protocol-timeout=630</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Option (<span class="id">--sck-keep-alive</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive enable.
</div><div class="section-body-text">
Enables keep-alive messages on socket connections.
</div>
<pre class="code-block">default: y
example: --no-sck-keep-alive</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Stanza Option (<span class="id">--stanza</span>)
</div></div><div class="section-body"><div class="section-body-text">
Defines the stanza.
</div><div class="section-body-text">
A stanza is the configuration for a <span class="postgres">PostgreSQL</span> database cluster that defines where it is located, how it will be backed up, archiving options, etc. Most db servers will only have one <span class="postgres">PostgreSQL</span> database cluster and therefore one stanza, whereas backup servers will have a stanza for every database cluster that needs to be backed up.
</div><div class="section-body-text">
It is tempting to name the stanza after the primary cluster but a better name describes the databases contained in the cluster. Because the stanza name will be used for the primary and all replicas it is more appropriate to choose a name that describes the actual function of the cluster, such as app or dw, rather than the local cluster name, such as main or prod.
</div>
<pre class="code-block">example: --stanza=main</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Count Option (<span class="id">--tcp-keep-alive-count</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive count.
</div><div class="section-body-text">
Specifies the number of TCP keep-alive messages that can be lost before the connection is considered dead.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPCNT</span> socket option.
</div>
<pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Idle Option (<span class="id">--tcp-keep-alive-idle</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive idle time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) with no network activity after which the operating system should send a TCP keep-alive message.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPIDLE</span> socket option.
</div>
<pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre>
</div></div><div class="section3"><a id="command-verify/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Keep Alive Interval Option (<span class="id">--tcp-keep-alive-interval</span>)
</div></div><div class="section-body"><div class="section-body-text">
Keep-alive interval time.
</div><div class="section-body-text">
Specifies the amount of time (in seconds) after which a TCP keep-alive message that has not been acknowledged should be retransmitted.
</div><div class="section-body-text">
This option is available on systems that support the <span class="id">TCP_KEEPINTVL</span> socket option.
</div>
<pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre>
</div></div></div></div><div class="section2"><a id="command-verify/category-log"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Log Options
</div></div><div class="section-body"><div class="section3"><a id="command-verify/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Console Log Level Option (<span class="id">--log-level-console</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for console logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: warn
example: --log-level-console=error</pre>
</div></div><div class="section3"><a id="command-verify/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
File Log Level Option (<span class="id">--log-level-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for file logging.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: info
example: --log-level-file=debug</pre>
</div></div><div class="section3"><a id="command-verify/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Std Error Log Level Option (<span class="id">--log-level-stderr</span>)
</div></div><div class="section-body"><div class="section-body-text">
Level for stderr logging.
</div><div class="section-body-text">
Specifies which log levels will output to <span class="id">stderr</span> rather than <span class="id">stdout</span> (specified by <span class="br-option">log-level-console</span>). The timestamp and process will not be output to <span class="id">stderr</span>.
</div><div class="section-body-text">
The following log levels are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">off</span> - No logging at all (not recommended)
</li><li class="list-unordered">
<span class="id">error</span> - Log only errors
</li><li class="list-unordered">
<span class="id">warn</span> - Log warnings and errors
</li><li class="list-unordered">
<span class="id">info</span> - Log info, warnings, and errors
</li><li class="list-unordered">
<span class="id">detail</span> - Log detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">debug</span> - Log debug, detail, info, warnings, and errors
</li><li class="list-unordered">
<span class="id">trace</span> - Log trace (very verbose debugging), debug, info, warnings, and errors
</li></ul>
<pre class="code-block">default: off
example: --log-level-stderr=error</pre>
</div></div><div class="section3"><a id="command-verify/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Path Option (<span class="id">--log-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where log files are stored.
</div><div class="section-body-text">
The log path provides a location for <span class="backrest">pgBackRest</span> to store log files. Note that if <span class="br-setting">log-level-file=off</span> then no log path is required.
</div>
<pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre>
</div></div><div class="section3"><a id="command-verify/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Subprocesses Option (<span class="id">--log-subprocess</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable logging in subprocesses.
</div><div class="section-body-text">
Enable file logging for any subprocesses created by this process using the log level specified by <span class="br-option">log-level-file</span>.
</div>
<pre class="code-block">default: n
example: --log-subprocess</pre>
</div></div><div class="section3"><a id="command-verify/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Log Timestamp Option (<span class="id">--log-timestamp</span>)
</div></div><div class="section-body"><div class="section-body-text">
Enable timestamp in logging.
</div><div class="section-body-text">
Enables the timestamp in console and file logging. This option is disabled in special situations such as generating documentation.
</div>
<pre class="code-block">default: y
example: --no-log-timestamp</pre>
</div></div></div></div><div class="section2"><a id="command-verify/category-maintainer"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Maintainer Options
</div></div><div class="section-body"><div class="section3"><a id="command-verify/category-maintainer/option-pg-version-force"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Force PostgreSQL Version Option (<span class="id">--pg-version-force</span>)
</div></div><div class="section-body"><div class="section-body-text">
Force <span class="postgres">PostgreSQL</span> version.
</div><div class="section-body-text">
The specified <span class="postgres">PostgreSQL</span> version will be used instead of the version automatically detected by reading <span class="file">pg_control</span> or WAL headers. This is mainly useful for <span class="postgres">PostgreSQL</span> forks or development versions where those values are different from the release version. The version reported by <span class="postgres">PostgreSQL</span> via `server_version_num` must match the forced version.
</div><div class="admonition"><div class="warning">
WARNING:
</div><div class="warning-text">
Be cautious when using this option because <span class="file">pg_control</span> and WAL headers will still be read with the expected format for the specified version, i.e. the format from the official open-source version of <span class="postgres">PostgreSQL</span>. If the fork or development version changes the format of the fields that <span class="backrest">pgBackRest</span> depends on it will lead to unexpected behavior. In general, this option will only work as expected if the fork adds all custom struct members <i>after</i> the standard <span class="postgres">PostgreSQL</span> members.
</div></div>
<pre class="code-block">example: --pg-version-force=15</pre>
</div></div></div></div><div class="section2"><a id="command-verify/category-repository"></a><div class="section2-header"><div class="section2-number"></div><div class="section2-title">
Repository Options
</div></div><div class="section-body"><div class="section3"><a id="command-verify/category-repository/option-repo"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Set Repository Option (<span class="id">--repo</span>)
</div></div><div class="section-body"><div class="section-body-text">
Set repository.
</div><div class="section-body-text">
Set the repository for a command to operate on.
</div><div class="section-body-text">
For example, this option may be used to perform a restore from a specific repository, rather than letting <span class="backrest">pgBackRest</span> choose.
</div>
<pre class="code-block">allowed: 1-256
example: --repo=1</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-azure-container"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Container Option (<span class="id">--repo-azure-container</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository container.
</div><div class="section-body-text">
Azure container used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the container root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other Azure-generated content can also be stored in the container.
</div>
<pre class="code-block">example: --repo1-azure-container=pg-backup</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-azure-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository Key Type Option (<span class="id">--repo-azure-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared key
</li><li class="list-unordered">
<span class="id">sas</span> - Shared access signature
</li></ul>
<pre class="code-block">default: shared
example: --repo1-azure-key-type=sas</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-azure-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Azure Repository URI Style Option (<span class="id">--repo-azure-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
Azure URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">account.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend account to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-azure-uri-style=path</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Cipher Type Option (<span class="id">--repo-cipher-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Cipher used to encrypt the repository.
</div><div class="section-body-text">
The following cipher types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">none</span> - The repository is not encrypted
</li><li class="list-unordered">
<span class="id">aes-256-cbc</span> - Advanced Encryption Standard with 256 bit key length
</li></ul><div class="section-body-text">
Note that encryption is always performed client-side even if the repository type (e.g. S3) supports encryption.
</div>
<pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-gcs-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Bucket Option (<span class="id">--repo-gcs-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository bucket.
</div><div class="section-body-text">
GCS bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other GCS-generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-gcs-bucket=/pg-backup</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-gcs-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Endpoint Option (<span class="id">--repo-gcs-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository endpoint.
</div><div class="section-body-text">
Endpoint used to connect to the storage service. May be updated to use a local GCS server or alternate endpoint.
</div>
<pre class="code-block">default: storage.googleapis.com
example: --repo1-gcs-endpoint=localhost</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-gcs-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
GCS Repository Key Type Option (<span class="id">--repo-gcs-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
GCS repository key type.
</div><div class="section-body-text">
The following types are supported for authorization:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">auto</span> - Authorize using the instance service account.
</li><li class="list-unordered">
<span class="id">service</span> - Service account from locally stored key.
</li><li class="list-unordered">
<span class="id">token</span> - For local testing, e.g. <span class="file">fakegcs</span>.
</li></ul><div class="section-body-text">
When <span class="br-option">repo-gcs-key-type=service</span> the credentials will be reloaded when the authentication token is renewed.
</div>
<pre class="code-block">default: service
example: --repo1-gcs-key-type=auto</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Option (<span class="id">--repo-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host when operating remotely.
</div><div class="section-body-text">
When backing up and archiving to a locally mounted filesystem this setting is not required.
</div>
<pre class="code-block">example: --repo1-host=repo1.domain.com</pre>
<div class="section-body-text">
Deprecated Name: backup-host
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority File Option (<span class="id">--repo-host-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority file.
</div><div class="section-body-text">
Use a CA file other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate Authority Path Option (<span class="id">--repo-host-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate authority path.
</div><div class="section-body-text">
Use a CA path other than the system default for connecting to the repository host.
</div>
<pre class="code-block">example: --repo1-host-ca-path=/etc/pki/tls/certs</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-cert-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Certificate File Option (<span class="id">--repo-host-cert-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host certificate file.
</div><div class="section-body-text">
Sent to repository host to prove client identity.
</div>
<pre class="code-block">example: --repo1-host-cert-file=/path/to/client.crt</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Command Option (<span class="id">--repo-host-cmd</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host <span class="backrest">pgBackRest</span> command.
</div><div class="section-body-text">
Required only if the path to the <span class="backrest">pgBackRest</span> command is different on the local and repository hosts. If not defined, the repository host command will be set the same as the local command.
</div>
<pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre>
<div class="section-body-text">
Deprecated Name: backup-cmd
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Option (<span class="id">--repo-host-config</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration file.
</div><div class="section-body-text">
Sets the location of the configuration file on the repository host. This is only required if the repository host configuration file is in a different location than the local configuration file.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_FILE
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre>
<div class="section-body-text">
Deprecated Name: backup-config
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Include Path Option (<span class="id">--repo-host-config-include-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration include path.
</div><div class="section-body-text">
Sets the location of the configuration include path on the repository host. This is only required if the repository host configuration include path is in a different location than the local configuration include path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH "/" PROJECT_CONFIG_INCLUDE_PATH
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Configuration Path Option (<span class="id">--repo-host-config-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
<span class="backrest">pgBackRest</span> repository host configuration path.
</div><div class="section-body-text">
Sets the location of the configuration path on the repository host. This is only required if the repository host configuration path is in a different location than the local configuration path.
</div>
<pre class="code-block">default: CFGOPTDEF_CONFIG_PATH
example: --repo1-host-config-path=/conf/pgbackrest</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Key File Option (<span class="id">--repo-host-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host key file.
</div><div class="section-body-text">
Proves client certificate was sent by owner.
</div>
<pre class="code-block">example: --repo1-host-key-file=/path/to/client.key</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Port Option (<span class="id">--repo-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host port when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Use this option to specify a non-default port for the repository host protocol.
</div>
<pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre>
<div class="section-body-text">
Deprecated Name: backup-ssh-port
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host Protocol Type Option (<span class="id">--repo-host-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host protocol type.
</div><div class="section-body-text">
The following protocol types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">ssh</span> - Secure Shell.
</li><li class="list-unordered">
<span class="id">tls</span> - <span class="backrest">pgBackRest</span> TLS server.
</li></ul>
<pre class="code-block">default: ssh
example: --repo1-host-type=tls</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Host User Option (<span class="id">--repo-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository host user when <span class="br-setting">repo-host</span> is set.
</div><div class="section-body-text">
Defines the user that will be used for operations on the repository host. Preferably this is not the <span class="id">postgres</span> user but rather some other user like <span class="id">pgbackrest</span>. If <span class="postgres">PostgreSQL</span> runs on the repository host the <span class="id">postgres</span> user can be placed in the <span class="id">pgbackrest</span> group so it has read permissions on the repository without being able to damage the contents accidentally.
</div>
<pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre>
<div class="section-body-text">
Deprecated Name: backup-user
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Path Option (<span class="id">--repo-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Path where backups and archive are stored.
</div><div class="section-body-text">
The repository is where <span class="backrest">pgBackRest</span> stores backups and archives WAL segments.
</div><div class="section-body-text">
It may be difficult to estimate in advance how much space you'll need. The best thing to do is take some backups then record the size of different types of backups (full/incr/diff) and measure the amount of WAL generated per day. This will give you a general idea of how much space you'll need, though of course requirements will likely change over time as your database evolves.
</div>
<pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Bucket Option (<span class="id">--repo-s3-bucket</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository bucket.
</div><div class="section-body-text">
S3 bucket used to store the repository.
</div><div class="section-body-text">
<span class="backrest">pgBackRest</span> repositories can be stored in the bucket root by setting <span class="br-option">repo-path=/</span> but it is usually best to specify a prefix, such as <span class="path">/repo</span>, so logs and other AWS generated content can also be stored in the bucket.
</div>
<pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Endpoint Option (<span class="id">--repo-s3-endpoint</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository endpoint.
</div><div class="section-body-text">
The AWS endpoint should be valid for the selected region.
</div><div class="section-body-text">
For custom/test configurations the <span class="br-setting">repo-storage-ca-file</span>, <span class="br-setting">repo-storage-ca-path</span>, <span class="br-setting">repo-storage-host</span>, <span class="br-setting">repo-storage-port</span>, and <span class="br-setting">repo-storage-verify-tls</span> options may be useful.
</div>
<pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-s3-key-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Key Type Option (<span class="id">--repo-s3-key-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository key type.
</div><div class="section-body-text">
The following types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">shared</span> - Shared keys
</li><li class="list-unordered">
<span class="id">auto</span> - Automatically retrieve temporary credentials
</li><li class="list-unordered">
<span class="id">web-id</span> - Automatically retrieve web identity credentials
</li></ul>
<pre class="code-block">default: shared
example: --repo1-s3-key-type=auto</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-s3-kms-key-id"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository KMS Key ID Option (<span class="id">--repo-s3-kms-key-id</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository KMS key.
</div><div class="section-body-text">
Setting this option enables S3 server-side encryption using the specified AWS key management service key.
</div>
<pre class="code-block">example: --repo1-s3-kms-key-id=bceb4f13-6939-4be3-910d-df54dee817b7</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Region Option (<span class="id">--repo-s3-region</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository region.
</div><div class="section-body-text">
The AWS region where the bucket was created.
</div>
<pre class="code-block">example: --repo1-s3-region=us-east-1</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-s3-role"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository Role Option (<span class="id">--repo-s3-role</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 repository role.
</div><div class="section-body-text">
The AWS role name (not the full ARN) used to retrieve temporary credentials when <span class="br-option">repo-s3-key-type=auto</span>.
</div>
<pre class="code-block">example: --repo1-s3-role=authrole</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
S3 Repository URI Style Option (<span class="id">--repo-s3-uri-style</span>)
</div></div><div class="section-body"><div class="section-body-text">
S3 URI Style.
</div><div class="section-body-text">
The following URI styles are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">host</span> - Connect to <span class="id">bucket.endpoint</span> host.
</li><li class="list-unordered">
<span class="id">path</span> - Connect to <span class="id">endpoint</span> host and prepend bucket to URIs.
</li></ul>
<pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Option (<span class="id">--repo-sftp-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host.
</div><div class="section-body-text">
The SFTP host containing the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host=sftprepo.domain</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-host-fingerprint"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Fingerprint Option (<span class="id">--repo-sftp-host-fingerprint</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host fingerprint.
</div><div class="section-body-text">
SFTP repository host fingerprint generation should match the <span class="br-setting">repo-sftp-host-key-hash-type</span>. Generate the fingerprint via <span class="id">awk '{print $2}' ssh_host_xxx_key.pub | base64 -d | (md5sum or sha1sum) -b</span>. The ssh host keys are normally found in the <span class="path">/etc/ssh</span> directory.
</div>
<pre class="code-block">example: --repo1-sftp-host-fingerprint=f84e172dfead7aeeeae6c1fdfb5aa8cf</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-host-key-check-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Host Key Check Type Option (<span class="id">--repo-sftp-host-key-check-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP host key check type.
</div><div class="section-body-text">
The following SFTP host key check types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">strict</span> - <span class="backrest">pgBackRest</span> will never automatically add host keys to the ~/.ssh/known_hosts file, and refuses to connect to hosts whose host key has changed or is not found in the known hosts files. This option forces the user to manually add all new hosts.
</li><li class="list-unordered">
<span class="id">accept-new</span> - <span class="backrest">pgBackRest</span> will automatically add new host keys to the user's known hosts file, but will not permit connections to hosts with changed host keys.
</li><li class="list-unordered">
<span class="id">fingerprint</span> - <span class="backrest">pgBackRest</span> will check the host key against the fingerprint specified by the <span class="br-option">repo-sftp-host-fingerprint</span> option.
</li><li class="list-unordered">
<span class="id">none</span> - no host key checking will be performed.
</li></ul>
<pre class="code-block">default: strict
example: --repo1-sftp-host-key-check-type=accept-new</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-host-key-hash-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Key Hash Type Option (<span class="id">--repo-sftp-host-key-hash-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host key hash type.
</div><div class="section-body-text">
SFTP repository host key hash type. Declares the hash type to be used to compute the digest of the remote system's host key on SSH startup. Newer versions of <span class="id">libssh2</span> support <span class="id">sha256</span> in addition to md5 and sha1.
</div>
<pre class="code-block">example: --repo1-sftp-host-key-hash-type=sha256</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-host-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host Port Option (<span class="id">--repo-sftp-host-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host port.
</div><div class="section-body-text">
SFTP repository host port.
</div>
<pre class="code-block">default: 22
allowed: 1-65535
example: --repo1-sftp-host-port=22</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-host-user"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Host User Option (<span class="id">--repo-sftp-host-user</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP repository host user.
</div><div class="section-body-text">
User on the host used to store the repository.
</div>
<pre class="code-block">example: --repo1-sftp-host-user=pg-backup</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-known-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Known Hosts File Option (<span class="id">--repo-sftp-known-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP known hosts file.
</div><div class="section-body-text">
A known hosts file to search for an SFTP host match during authentication. When unspecified, <span class="backrest">pgBackRest</span> will default to searching <span class="file">~/.ssh/known_hosts</span>, <span class="file">~/.ssh/known_hosts2</span>, <span class="file">/etc/ssh/ssh_known_hosts</span>, and <span class="file">/etc/ssh/ssh_known_hosts2</span>. If configured with one or more file paths, <span class="backrest">pgBackRest</span> will search those for a match. File paths must be full or leading tilde paths. The <span class="br-setting">repo-sftp-known-host</span> option can be passed multiple times to specify more than one known hosts file to search. To utilize known hosts file checking <span class="br-setting">repo-sftp-host-fingerprint</span> must not be specified. See also <span class="br-setting">repo-sftp-host-check-type</span> option.
</div>
<pre class="code-block">example: --repo1-sftp-known-host=/home/postgres/.ssh/known_hosts</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-private-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Private Key File Option (<span class="id">--repo-sftp-private-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP private key file.
</div><div class="section-body-text">
SFTP private key file used for authentication.
</div>
<pre class="code-block">example: --repo1-sftp-private-key-file=~/.ssh/id_ed25519</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-sftp-public-key-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
SFTP Repository Public Key File Option (<span class="id">--repo-sftp-public-key-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
SFTP public key file.
</div><div class="section-body-text">
SFTP public key file used for authentication. Optional if compiled against OpenSSL, required if compiled against a different library.
</div>
<pre class="code-block">example: --repo1-sftp-public-key-file=~/.ssh/id_ed25519.pub</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-storage-ca-file"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage CA File Option (<span class="id">--repo-storage-ca-file</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA file.
</div><div class="section-body-text">
Use a CA file other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-file, repo-s3-ca-file
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-storage-ca-path"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage TLS CA Path Option (<span class="id">--repo-storage-ca-path</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage CA path.
</div><div class="section-body-text">
Use a CA path other than the system default for storage (e.g. S3, Azure) certificates.
</div>
<pre class="code-block">example: --repo1-storage-ca-path=/etc/pki/tls/certs</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-ca-path, repo-s3-ca-path
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-storage-host"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Host Option (<span class="id">--repo-storage-host</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage host.
</div><div class="section-body-text">
Connect to a host other than the storage (e.g. S3, Azure) endpoint. This is typically used for testing.
</div>
<pre class="code-block">example: --repo1-storage-host=127.0.0.1</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-host, repo-s3-host
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-storage-port"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Port Option (<span class="id">--repo-storage-port</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage port.
</div><div class="section-body-text">
Port to use when connecting to the storage (e.g. S3, Azure) endpoint (or host if specified).
</div>
<pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-storage-port=9000</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-port, repo-s3-port
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-storage-tag"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Tag Option (<span class="id">--repo-storage-tag</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage tag(s).
</div><div class="section-body-text">
Specify tags that will be added to objects when the repository is an object store (e.g. S3). The option can be repeated to add multiple tags.
</div><div class="section-body-text">
There is no provision in <span class="backrest">pgBackRest</span> to modify these tags so be sure to set them correctly before running <span class="cmd">stanza-create</span> to ensure uniform tags across the entire repository.
</div>
<pre class="code-block">example: --repo1-storage-tag=key1=value1</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-storage-upload-chunk-size"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Upload Chunk Size Option (<span class="id">--repo-storage-upload-chunk-size</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage upload chunk size.
</div><div class="section-body-text">
Object stores such as S3 allow files to be uploaded in chunks when the file is too large to be stored in memory. Even if the file can be stored in memory, it is more memory efficient to limit the amount of memory used for uploads.
</div><div class="section-body-text">
A larger chunk size will generally lead to better performance because it will minimize upload requests and allow more files to be uploaded in a single request rather than in chunks. The disadvantage is that memory usage will be higher and because the chunk buffer must be allocated per process, larger <span class="br-option">process-max</span> values will lead to more memory being consumed overall.
</div><div class="section-body-text">
Default chunk sizes by repo type:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - 4MiB
</li><li class="list-unordered">
<span class="id">gcs</span> - 4MiB
</li><li class="list-unordered">
<span class="id">s3</span> - 5MiB
</li></ul><div class="section-body-text">
Note that valid chunk sizes vary by storage type and by platform. For example, <span class="host">AWS S3</span> has a minimum chunk size of 5MiB but <span class="host">S3</span> clones may accept lower values. Terminology for chunk size varies by storage type, so when searching min/max values use <q>part size</q> for <span class="host">AWS S3</span>, <q>chunk size</q> for <span class="host">GCS</span>, and <q>block size</q> for <span class="host">Azure</span>. No attempt is made to validate configured chunk sizes so selecting an invalid value will lead to errors from the storage service or undefined behavior.
</div>
<pre class="code-block">allowed: 64KiB-1TiB
example: --repo1-storage-upload-chunk-size=16MiB</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-storage-verify-tls"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Storage Certificate Verify Option (<span class="id">--repo-storage-verify-tls</span>)
</div></div><div class="section-body"><div class="section-body-text">
Repository storage certificate verify.
</div><div class="section-body-text">
This option provides the ability to enable/disable verification of the storage (e.g. S3, Azure) server TLS certificate. Disabling should only be used for testing or other scenarios where a certificate has been self-signed.
</div>
<pre class="code-block">default: y
example: --no-repo1-storage-verify-tls</pre>
<div class="section-body-text">
Deprecated Names: repo-azure-verify-tls, repo-s3-verify-ssl, repo-s3-verify-tls
</div></div></div><div class="section3"><a id="command-verify/category-repository/option-repo-target-time"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Target Time for Repository Option (<span class="id">--repo-target-time</span>)
</div></div><div class="section-body"><div class="section-body-text">
Target time for repository.
</div><div class="section-body-text">
The target time defines the time that commands use to read a repository on versioned storage. This allows the command to read the repository as it was at a point-in-time in order to recover data that has been deleted or corrupted by user accident or malware.
</div><div class="section-body-text">
Versioned storage is supported by <span class="host">S3</span>, <span class="host">GCS</span>, and <span class="host">Azure</span> but is generally not enabled by default. In addition to enabling versioning, it may be useful to enable object locking for <span class="host">S3</span> and soft delete for <span class="host">GCS</span> or <span class="host">Azure</span>.
</div><div class="section-body-text">
When the <span class="br-option">repo-target-time</span> option is specified then the <span class="br-option">repo</span> option must also be provided. It is likely that not all repository types will support versioning and in general it makes sense to target a single repository for recovery.
</div><div class="section-body-text">
Note that comparisons to the storage timestamp are <= the timestamp provided and milliseconds are truncated from the timestamp when provided.
</div>
<pre class="code-block">example: --repo-target-time=2024-08-08 12:12:12+00</pre>
</div></div><div class="section3"><a id="command-verify/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number"></div><div class="section3-title">
Repository Type Option (<span class="id">--repo-type</span>)
</div></div><div class="section-body"><div class="section-body-text">
Type of storage used for the repository.
</div><div class="section-body-text">
The following repository types are supported:
</div><ul class="list-unordered"><li class="list-unordered">
<span class="id">azure</span> - Azure Blob Storage Service
</li><li class="list-unordered">
<span class="id">cifs</span> - Like <span class="id">posix</span>, but disables links and directory fsyncs
</li><li class="list-unordered">
<span class="id">gcs</span> - Google Cloud Storage
</li><li class="list-unordered">
<span class="id">posix</span> - Posix-compliant file systems
</li><li class="list-unordered">
<span class="id">s3</span> - AWS Simple Storage Service
</li><li class="list-unordered">
<span class="id">sftp</span> - Secure File Transfer Protocol
</li></ul><div class="section-body-text">
When an <span class="host">NFS</span> mount is used as a <span class="id">posix</span> repository, the same rules apply to <span class="backrest">pgBackRest</span> as described in the <span class="postgres">PostgreSQL</span> documentation: <a href="https://www.postgresql.org/docs/current/creating-cluster.html#CREATING-CLUSTER-FILESYSTEM">Creating a Database Cluster - File Systems</a>.
</div>
<pre class="code-block">default: posix
example: --repo1-type=cifs</pre>
</div></div></div></div></div></div><div class="section1"><a id="command-version"></a><div class="section1-header"><div class="section1-number"></div><div class="section1-title">
Version Command (<span class="id">version</span>)
</div></div><div class="section-body"><div class="section-body-text">
Displays installed <span class="backrest">pgBackRest</span> version.
</div></div></div></div><div class="page-footer">
Copyright &copy; 2015-2025, The PostgreSQL Global Development Group, <a href="https://github.com/pgbackrest/pgbackrest/blob/main/LICENSE">MIT License</a>. Updated January 28, 2025
</div></body></html>